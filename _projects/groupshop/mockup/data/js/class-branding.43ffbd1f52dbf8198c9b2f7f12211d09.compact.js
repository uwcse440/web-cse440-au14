var branding=(function(){var k={},c={iPadRetina:{width:1024,height:768,pixelRatio:2,icon:152,splashP:"1536x2008",splashL:"2048x1496"},iPad:{width:768,height:1024,pixelRatio:1,icon:152,splashP:"768x1004",splashL:"1024x748"},iPhone5:{width:320,height:568,pixelRatio:2,icon:120,splash:"640x1096"},iPhone4:{width:320,height:480,pixelRatio:2,icon:120,splash:"640x920"},iPhone:{width:320,height:480,pixelRatio:1,icon:120,splash:"320x460"},iPhone6:{width:375,height:667,pixelRatio:1,icon:120,splash:"750x1334"},"iPhone6+":{width:414,height:736,pixelRatio:3,icon:180,splash:"1242x2208"}},m={splashPiPad:[{x:768,y:1004},{x:1536,y:2008}],splashLiPad:[{x:1024,y:748},{x:2048,y:1496}],splashiPhone5:[{x:640,y:1096}],splashiPhone6:[{x:1242,y:2208}],"splashiPhone6+":[{x:640,y:1096}],splashiPhone:[{x:320,y:460},{x:640,y:920}]},j={};function d(){var o,n;for(o in c){if(c.hasOwnProperty(o)&&screen.width===c[o].width&&screen.height===c[o].height&&window.devicePixelRatio===c[o].pixelRatio){n=o;break}}return n?{device:n,screen:c[n]}:{device:"",screen:{splashP:"",splashL:""}}}function g(y,x,v,q){q=q||projectSettings.getLastSelectedObject();if(y){if(k[y]!==null&&k[y]!==undefined){var o=y+"Branding",z=!project.isOpen(q.id),r=z?q:{};if(k[y]){var w=m[y]&&m[y].length,s=0;if(w){r[o]=q[o]||{};for(;s<w;s++){var A=m[y][s],p=utils.guid("j"),u=fluid.util.dataUrlToBlob(fluid.util.resizeImage(k[y].dataUrl,A.x,A.y),{type:"image/png"}),n=[A.x+"x"+A.y],t=z?r[o]:project.get(o);j[p]={remove:(t instanceof Object)?t[n]:t,key:y,onSuccess:x,onError:v,proj:q};ajax.apiCall("img","post",p,u,i,l);r[o][n]=p}}else{var p=utils.guid("i");j[p]={remove:z?r[o]:project.get(o),key:y,onSuccess:x,onError:v,proj:q};ajax.apiCall("img","post",p,k[y].file,i,l);r[o]=p}k[y]=null}else{r[o]="";k[y]=null}if(z){project.sync(q.id,null)}else{project.set(r)}}return}for(y in k){if(k.hasOwnProperty(y)){g(y,x,v,q)}}}function i(p,q){var n=j[q],o=n&&n.proj||projectSettings.getLastSelectedObject();if(n&&n.remove){ajax.apiCall("img","delete",n.remove)}j[q]=null;typeof n.onSuccess==="function"&&n.onSuccess.apply(this,arguments)}function l(q,s){var n=j[s],p=n&&n.proj||projectSettings.getLastSelectedObject(),r=!project.isOpen(p.id),o=r?p:{};notification.add("alert",f(n.key)+" branding image could not be uploaded. Please try again.");if(n&&n.remove){if(n.details){o[n.key+"Branding"]=o[key+"Branding"]||{};o[n.key+"Branding"][details]=n.remove}else{o[n.key+"Branding"]=n.remove}typeof n.onError==="function"&&n.onError.apply(this,arguments)}if(r){project.sync(projObject.id,null)}else{project.set(o)}j[s]=null}function h(o,n,q){var p=(q?q:projectSettings.getLastSelectedObject())[o+"Branding"];if(p instanceof Object){if(n===undefined||n===null||n===""){n=m[o]&&m[o][0].x+"x"+m[o][0].y}p=p[n]}return p?ajax.apiObjectUrl("img",p):""}function e(o,n,q){var p=(q?q:projectSettings.getLastSelectedObject())[o+"Branding"];if(p instanceof Object){if(n===undefined||n===null||n===""){n=m[o]&&m[o][0];return p[n]||p}return p[n]}return p}function f(n){if(/icon/.test(n)){return"App Icon"}if(/iPhone/.test(n)){return"Loading image"}if(/splashP/.test(n)){return"Portrait Splash image"}if(/splashL/.test(n)){return"Landscape Splash image"}return}function a(o,q,r,p){if(q){if(!/^image\/(png|jpeg)$/i.test(q.type)){notification.add("alert","You may only upload JPEG and PNG images");return}var n=new FileReader();n.onloadend=function(s){if(s.target.readyState===FileReader.DONE){k[o]={file:q,dataUrl:s.target.result};if(typeof r==="function"){r(s.target.result)}}else{if(typeof p==="function"){p(s)}}};n.onerror=p;n.readAsDataURL(q)}else{k[o]=""}}function b(n){if(n){k[n]=null}else{for(n in k){if(k.hasOwnProperty(n)){k[n]=null}}}}return{changeImage:a,resetChange:b,update:g,getUrl:h,get:e,screens:c,sizes:m,getTitle:f,deviceScreen:d}}());