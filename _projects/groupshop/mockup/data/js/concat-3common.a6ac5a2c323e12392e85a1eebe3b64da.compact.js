var preview={url:null,printURL:null,embedURL:null,pageTransitioning:false,multiOrientations:false,projectWH:[320,480],delayStart:1000,loaded:false,pageScale:1,pageRotation:0,pageTranslation:[0,0],viewportScaled:false,currentFrameScale:1,navigationStackBack:[],navigationStackForward:[],navigationQueueNext:[],navigationQueueFlow:[],navigationCompleted:false,navigationEnabled:false,navigationDefaultTransition:null,parentWindow:null,parentDoc:null,useZoomSlider:false,pageNotes:{},isOpen:false,initExported:function(){if($("#previewPage").size()>0){$(window).on("message",preview._crossDomainCallListener)}preview._showPreviewPage(false)},scaleFrame:function(l,i,o){i=i||false;l=l||false;if(!preview.loaded&&!i&&l){return}if(window.g_print||window.g_embedded||window.g_imgExport=="true"){return}var c=preview.parentWindow||window,f=c.document,b=$("#previewPage",f),h=window;if(b[0]){h=b[0].contentWindow}else{if(preview.parentWindow){b=$("#previewPage",f)}else{if(window.parent!==window){preview._crossDomainCall(window.parent,"scaleFrame",arguments);return}}}if(!l&&!b[0]){if(utils.isMobileDevice()){preview.scaleViewport()}return}var e,a=f.getElementById("previewZoomSlider");if(!o&&a&&h.preview&&h.preview.useZoomSlider){e=a.value}else{var k=b.outerWidth(),d=b.outerHeight(),p=Math.max(k,d),g=(o?{width:k,height:d}:{width:p,height:p}),n=(o?{width:c.innerWidth,height:c.innerHeight}:preview.availableRect),m=utils.getFitSize({object:g,frame:n,expand:o});e=m.width/g.width}if(!preview.useZoomSlider&&a&&typeof e==="number"){var j=c.$(a);if(j){j.slider("value",e)}}if(o){if(c===window){b[0].contentWindow.preview.useZoomSlider=true}else{preview.useZoomSlider=true}}b.css({"-webkit-transform":"scale("+e+")","-moz-transform":"scale("+e+")","transform":"scale("+e+")"});preview.centerFrame(c);preview.positionNotes();preview.currentFrameScale=e;preview._showPreviewPage(true)},scaleViewport:function(h){if(!preview.viewportScaled){h=h||$(".ui-page-active");var f=$(".ui-content",h);var d=window.innerWidth;var g=preview.getTrueHeight();var c=d>g?[g,d]:[d,g];var a=preview.projectWH[0];var e=preview.projectWH[1];var b=a>e?[e,a]:[a,e];preview.pageScale=Math.min(c[0]/b[0],c[1]/b[1]);if(utils.hideBrowserBar()){window.scrollTo(0,1)}}},applyPageTransforms:function(c){var e=preview.pageScale!==1?"scale("+preview.pageScale+") ":"";var b=preview.pageRotation!=0?"rotate("+preview.pageRotation+"deg)":"";var d=(preview.pageTranslation[0]||preview.pageTranslation[1])?" translate("+preview.pageTranslation[0]+"px,"+preview.pageTranslation[1]+"px)":"";var a=e+b+d;$(".widgetHolder",c).css({"-webkit-transform":a,"-moz-transform":a,"transform":a})},_showPreviewPage:function(a){if(typeof a=="undefined"){a=true}var b=$("#previewPage");if(b.size()==0){if(preview.parentWindow){b=$("#previewPage",window.parent.document)}else{if(window.parent!==window){preview._crossDomainCall(window.parent,"_showPreviewPage",[a])}}}b.css({visibility:a?"visible":"hidden"})},updateExportUi:function(c){var d={Pages:$("#previewShareContainer .shareLinkExportImg").add("#projectSettingsShareTop .shareLinkExportImg"),Project:$("#previewShareContainer .shareLinkExportImgFull").add("#projectSettingsShareTop .shareLinkExportImgFull")};var h;var g=["Pages","Project"];var e;var b;for(var f=0,a=g.length;f<a;f++){e=c["export"+g[f]];h=d[g[f]].next(".msg");if(e&&e.snapshotId){if(e.status==="FINISHED"){h.html('<a class="export-link" rel="'+e.snapshotId+'">Download ('+e.processDate+")</a>");b=h.find(".export-link");b.click(function(i){window.open(document.location.origin+document.location.pathname+"snapshot/"+i,"_snapshot")}.bind(b,e.snapshotId));h.removeClass("pulsing")}else{if(e.status==="STARTED"||(e.status==="NEW"&&e.queue===0)){h.html("exporting...");h.addClass("pulsing");share.startExportPolling(e.snapshotId)}else{if(e.status==="NEW"){e;h.html("queued ("+e.queue+")...");h.addClass("pulsing");share.startExportPolling(e.snapshotId)}else{if(e.status==="FAILED"){h.html("export failed...");h.removeClass("pulsing")}}}}}else{h.html("");h.removeClass("pulsing")}}},getLastExports:function(){var a=project.get("id");$.ajax({url:"./index.php",type:"POST",data:{t:"getLastExport",objectId:a},success:function(b,e,d){var c=JSON.parse(b);preview.updateExportUi(c)}})},open:function(c,b){var d=project.get("id");var a=project.bundle(d);contextMenu.hide();ajax.syncUp(a,"projectSync",d,function(j){preview.getLastExports();canvas2.setEditorVisibility(false);$("#previewPage").contents().find("body").remove();$("#hud .hud-buttons .hud-secondary").hide();fluid.command.create("hideButton").dispatchTo("fluid.controllers.timeline");hint.show("startedPreview");preview.hideMenu();fluid.controllers.bin.hide();preview.hideNotes();if(document.getElementById("previewShowNotes").checked){preview.getNotesElement().style.display=""}else{preview.getNotesElement().style.display="none"}preview._showPreviewPage(false);var g=account.get("lastOpenProject");project.checkIntegrity(g);var i=project.get("pageWH");var f=project.isMultiOrientation();if(c&&(c.currentTarget.id=="preview"||c.currentTarget.id==="pagePreview")){project.save();project.sync();var k=(document.location.href).split("?");var h=g+"."+project.get("updated");share.init(g);preview.embedURL=k[0]+"embed/"+h;var e=$("#tmplEmbedCode").tmpl({url:preview.embedURL,width:f?Math.max(i[0],i[1]):i[0]+64,height:f?Math.max(i[0],i[1]):i[1],multiorient:f}).html();$("#embedCode").html(e)}if(account.get("loggedIn")!="yes"){$("#previewSignup").show();$("#previewShareContainer").hide()}$("#previewPage").css({width:i[0],height:i[1],webkitTransform:"scale(2)",transform:"scale(2)"}).attr("src","project/"+g);$("#previewHolder").fadeIn(200).addClass("open");$("#previewFrameParent").removeClass("to-landscape to-portrait");preview.setAvailableRect(preview.calcAvailableRect());preview.centerFrame();preview.isOpen=true})},close:function(){canvas2.setEditorVisibility(true);hint.restart();$("#hud .hud-buttons .hud-secondary").fadeIn(300);fluid.command.create("showButton").dispatchTo("fluid.controllers.timeline");$("#previewPage").find(".widgetHolder").empty();$("#previewSignup").hide();$("#previewShareContainer").show();$("#previewHolder").removeClass("open").fadeOut(200);$(".messageError").hide();signup.toggleTabMessage();preview.startPage=null;fluid.controllers.bin.show();fluid.main.fire("previewclosed");previewMenu.close();preview.isOpen=false},parseDownload:function(b,i,d){var g="Couldn't download correctly (has it been deleted/made inactive?)";try{var c=JSON.parse(d.responseText)}catch(h){$("body").html("Unable to parse download - unknown error (1)");throw ("Error Downloading "+item+"Caller:"+arguments.callee.caller+" Second level:"+arguments.callee.caller.caller+"loadSate"+loading_Stage_Check)}if(c.r!="s"){preview.displayErrorMessageOnLoad(g);return false}try{var f=JSON.parse(c.t.toString())}catch(h){preview.displayErrorMessageOnLoad("Unable to download the mockup - download was interrupted.")}if(!fluid.main.project&&g_preview){fluid.main.project=new fluid.models.project(f,{parse:true,projectId:g_preview,syncOnChange:false})}var c=f[g_preview];if(c&&c.active===false){var a=(location.origin==="file://")?window:top;preview.displayErrorMessageOnLoad("");preview._crossDomainCall(window.parent,"setFrameSize",[324,500]);$("#projectInactive").tmpl().appendTo("body");return false}if(preview.exported){preview.afterPreviewLoad(f)}else{return f}},displayErrorMessageOnLoad:function(a){$("body").html(a);preview.scaleFrame(true,true)},afterPreviewLoad:function(e){var l=[];var p=$("#homePage");if(innerWidth===300&&e[window.g_preview]&&e[window.g_preview].pageWH){l=e[window.g_preview].pageWH;if(l[0]<l[1]){p.css("background-size",l[0]+"px auto")}else{p.css("background-size","auto "+l[1]+"px")}}else{if(innerWidth<innerHeight){l[0]=innerWidth+"px";l[1]="auto"}else{l[0]="auto";l[1]=innerHeight+"px"}p.css("background-size",l[0]+" "+l[1])}var b=branding.deviceScreen(),c=b.device,m=b.screen,f=e[window.g_preview]||e,j=f.deviceModel,i,o,h=window.innerWidth>window.innerHeight,d=document.getElementById("homePageStyle"),g='<link id="appIcon" rel="apple-touch-icon" href="'+(branding.getUrl("icon",null,f)||"img/apple-touch-icon-144.png")+'" />';if(/iPhone/.test(j)){i=(branding.getUrl("splash"+j,m.splash,f)||"img/fluidLoading"+branding.screens[j].splash+".png");g+='<link id="splashP" rel="apple-touch-startup-image" href="'+i+'" />'}else{i=branding.getUrl("splashP"+j,m.splashP,f)||(m.splashP?"img/fluidLoading"+m.splashP+".png":"");o=branding.getUrl("splashL"+j,m.splashL,f)||(m.splashL?"img/fluidLoading"+m.splashL+".png":"");g+='<link id="splashP" rel="apple-touch-startup-image" sizes="'+m.splashP+'" media="(orientation: portrait)" href="'+i+'" />'+'<link id="splashL" rel="apple-touch-startup-image" sizes="'+m.splashL+'" media="(orientation: landscape)" href="'+o+'" />'}var k=f&&f.pageWH[0]||"1024px 748px;";var q=f&&f.pageWH[1]||"748px 1024px;";if(d){d.innerHTML="#homePage { background: url("+(h&&o?o:i)+") no-repeat bottom; "+"background-size: "+(/iPad/.test(j)?(h?"1024px 748px;":"764px 1004px;"):j==="iPhone5"?"320px 568px;":j==="iPhone"?"320px 460px;":k+"px "+q+"px;"+"}")}if(!c){if(!i&&!o){document.head.removeChild(d);$("#default-branding-links").tmpl().appendTo("head")}}$("head").append(g);try{preview.parentWindow.preview.setAvailableRect()}catch(n){preview._crossDomainCall(window.parent,"setAvailableRect")}$(document).ready(function a(r){if(utils.isMobileDevice()){$("body").addClass("mobile")}widget.useCanvas=true;preview.runDraw(e);$(window).bind("orientationchange",function(){$("body").scrollTop(0).scrollLeft(0);loading_Stage_Check="preview Loaded"})})},load:function(a,c){if(location.origin==="file://"||!frameElement){b()}else{$(frameElement).load(b)}function b(){dbStorage.onReady(function(){storage.init(function(){if(location.origin!=="file://"){$(frameElement).off("load")}try{preview.parentDoc=window.frameElement.ownerDocument;preview.parentWindow=preview.parentDoc.defaultView}catch(f){preview.parentWindow=null}var d=storage.get(a);if(d&&d.unloaded!==true){if(typeof c==="function"){c(d)}if(window.g_print){preview.runDraw(a)}}else{ajax.syncDown(a,function(e){var g=preview.parseDownload.apply(this,arguments);if(typeof c==="function"){c(g)}e=JSON.parse(e);var h=JSON.parse(e.t);if(window.g_print){preview.runDraw(h)}})}})})}},draw:function(t){if(!t){return false}if($.mobile){$.mobile.defaultHomeScroll=0}for(var w in t){storage.setTempItem(w,t[w])}var d=t[g_preview]||t;for(var n=0;n<d.pages.length;n++){var b=storage.get([d.pages[n]]);preview.pageNotes[d.pages[n]]=b&&b[3]||""}preview.viewportScaled=window.navigator.hasOwnProperty("standalone")&&window.navigator.standalone;preview.projectWH=[d.pageWH[0],d.pageWH[1]];var m=preview.viewportScaled?preview.projectWH[0]:$(window).width();var c=preview.viewportScaled?preview.projectWH[1]:preview.getTrueHeight();if(utils.isMobileDevice()&&m>c&&window.screen.width<window.screen.height){var r=m;m=c;c=r}var u=preview.viewportScaled?Math.min(window.screen.width/m,window.screen.height/c):1;if(/iP(hone|od|ad)/.test(navigator.platform)){var h=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);if(h&&h[1]&&h[1]==="6"){$("#metaViewport").attr("content","initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no")}}else{$("#metaViewport").attr("content","width="+m+",height="+c+",minimum-scale="+u+",maximum-scale="+u+",initial-scale="+u+",user-scalable=0")}if(preview.parentWindow){if(!window.g_embedded){try{var f=$("#previewPage",window.parent.document);if(f.size()>0){f.css({width:d.pageWH[0],height:d.pageWH[1]});$(".ui-mobile-viewport").css("overflow","hidden")}}catch(q){}}preview.scaleFrame()}else{if(window.parent!==window){preview._crossDomainCall(window.parent,"setFrameSize",d.pageWH);preview._crossDomainCall(window.parent,"scaleFrame")}}$(".pageList").css("height",preview.getTrueHeight()+"px");document.title=d.name;document.projectLoaded=true;for(var n=0;n<d.pages.length;n++){if(!storage.get(d.pages[n])){d.pages.splice(n,1);n--}}if(!storage.get(d.homepage)){d.homepage=d.pages[0]}var l=d.orientation;preview.multiOrientations=false;for(var n=0,o=d.pages.length;n<o;n++){if(storage.get(d.pages[n]).orientation!=l){preview.multiOrientations=true;break}}if(browserDetect.OS=="Android"&&preview.multiOrientations){var s=$(window).width();var g=window.outerHeight||getTrueHeight();$(".ui-mobile-viewport").css({"min-height":Math.max(s,g)+"px"})}if(window.g_embedded&&(preview.projectWH[0]>preview.projectWH[1]||preview.multiOrientations)){}if(window.g_print||window.g_imgExport){for(var n=0,o=d.pages.length;n<o;n++){preview.drawPage(d.pages[n],d)}$("#font-preloader").remove();if(window.g_imgExport){var k=[];var a={};for(var n=0;n<d.pages.length;n++){a=$.extend({},storage.get(d.pages[n]));a.id=d.pages[n];k.push(a)}preview.pagesArr=k;preview.pagesArr=k;setTimeout(function(){$("#home").hide();if(typeof window.callPhantom==="function"){window.callPhantom({event:"finishedrendering",pages:k})}},3000)}}else{var j=preview.parentWindow?preview.parentWindow.preview.startPage:null,p=j||(d.homepage?d.homepage:d.pages[0]);preview.homePage=p;preview.drawPage(p,d);if(typeof g_previewMode!="undefined"&&g_previewMode==true){preview.scaleViewport();preview.bindMobileEvents(d.links);g_homepage=p;setTimeout(function(){preview.changePage("#"+p,null,false,true)},preview.delayStart)}}},showPage:function(a){$(".previewPage").hide();$("#"+a).show();if(typeof window.callPhantom==="function"){window.callPhantom({event:"shownPage",id:a})}},drawPage:function(b,e){if(!e){e=storage.get(g_preview)}var f=window.g_imgExport=="true"?"white":"transparent";var g=storage.get(b);if(!g){return}var a=[g.width,g.height];var d={pageId:b,width:a[0],height:a[1],widthScreen:$(window).width(),heightScreen:preview.getTrueHeight(),bgColor:f};if(window.g_embedded){if(preview.multiOrientations){if(a[0]>a[1]){d.top=(a[0]-a[1])>>1}else{d.left=(a[1]-a[0])>>1}}else{d.left=$(".previewLogoHolder").outerWidth()}}if((window.g_print)&&(g.notes!=undefined)){d.notes=g.notes[3];d.title=g.name==undefined?"":g.name}var c=$("#tmplPreviewPage").tmpl(d).appendTo("body");preview.drawWidgets(g_preview,b,e.links);preview.showLinks(e.links,b);$("#"+b).bind("pageshow",preview.navigateInit);if(window.g_print){if(g.width===e.pageWH[0]&&g.height===e.pageWH[1]){c.addClass("project-size")}}},changePage:function(g,h,e,a){var c=g.substr(1);if($(g).size()==0){preview.drawPage(c);$(g).trigger("pageinit")}$(g).addClass("visited");var i=h;var b=a=="undefined"?true:!a;if((!i)&&(b)){var f=preview.navigationDefaultTransition.split(":");var d=(f.length>1)?true:false;i={transition:f[0],reverse:d}}preview.orient(null,$(g),$(".ui-page.ui-page-active"));if(utils.isMobileDevice()){$.mobile.changePage(g,i)}else{setTimeout(function(){$.mobile.changePage(g,i)},300)}if(window.Android){Android.updateOrientation()}window.setTimeout(function(){preview.preloadLinkedPages(c);preview._fixNavigationStatus(c,h,e)},100)},_fixNavigationStatus:function(c,d,e){if((preview.navigationStackBack.length>0)&&(e!=2)){var b=d;if(preview.navigationQueueNext.length>0){if(preview.navigationQueueNext[0].args){b=preview.navigationQueueNext[0].args;b.reverse=!b.reverse}}preview.navigationStackBack.push({pageId:c,args:b})}preview.navigationQueueFlow=$.grep(preview.navigationQueueFlow,function(g,f){return g.pageId!=c});var a=$("#"+c).hasClass("blank");if(!a){preview.navigationQueueFlow.push({pageId:c,args:d})}preview.navigationQueueNext=$.grep(preview.navigationQueueNext,function(g,f){return g.pageId!=c})},_isPageVisited:function(a){var b=$("#"+a);if((b.size()>0)&&(b.hasClass("visited"))){return true}return false},preloadLinkedPages:function(b){if((preview.navigationCompleted)&&(preview.navigationQueueFlow.length>1)){var f=preview.navigationQueueFlow.slice(0);var h=f.pop();preview.navigationStackBack.push(h);return}var d=storage.get(g_preview);var g=storage.get(b);var a=d.links;var e=0;var c=0;$.each(a.linkOrigin,function(n,k){if(a.linkType[n]=="ahref"&&$("#"+k).closest(".page").attr("id")==b){var j=a.linkDest[n];var q=storage.get(j);if(!q){return}var o=$("#"+j);if((o.size()==0)&&(q.widgets.length>0)){var r=a.transType[n].split(":");var m=(r.length>1)?true:false;var l={transition:r[0],reverse:m};preview.navigationQueueNext.push({pageId:j,args:l});preview.drawPage(j,d);e++}else{if(o.size()>0){if((preview.navigationQueueFlow.length>0)&&(j==preview.navigationQueueFlow[0].pageId)&&(!preview.navigationQueueFlow[0].args)){var r=a.transType[n].split(":");var m=(r.length>1)?true:false;preview.navigationQueueFlow[0].args={transition:r[0],reverse:m}}}}}if((preview.navigationStackBack.length==0)&&(c<1)){if((a.linkType[n]=="ahref")&&(a.linkDest[n]==b)){var j=preview.getPageIdForWidget(k);var q=storage.get(j);if(!q){return}if((!preview._isPageVisited(j))&&(q.widgets.length>0)){var r=a.transType[n].split(":");var m=(r.length>1)||r[0]=="none"?false:true;var l={transition:r[0],reverse:m};preview.navigationStackBack.push({pageId:j,args:l});c++}}}});preview.preloadNextUndisplayedPage(d);preview.preloadPreviousUndisplayedPage(d)},preloadNextUndisplayedPage:function(a){return preview.findUnlinkedPage(a,a.pages,preview.navigationQueueNext,true)},preloadPreviousUndisplayedPage:function(a){var d=a.pages.slice(0);preview.findUnlinkedPage(a,d.reverse(),preview.navigationStackBack,false);if((preview.navigationCompleted)&&(preview.navigationQueueFlow.length>1)){var b=preview.navigationQueueFlow.slice(0);var c=b.pop();preview.navigationStackBack.push(c)}},findUnlinkedPage:function(c,a,e,b){if((preview.navigationCompleted)||(e.length>0)){return false}var d=false;$.each(a,function(g,f){if(!preview._isPageVisited(f)){var h=storage.get(f);if(h.widgets.length>0){e.push({pageId:f,args:null});if(b){preview.drawPage(f,c)}d=true;return false}}});if(!d){preview.navigateSetCompleted()}return d},showLinks:function(b,a){$.each(b.linkOrigin,function(d,c){if(b.linkType[d]=="ahref"&&(!a||$("#"+c).closest(".page").attr("id")==a)){$("[id="+c+"]").addClass("widgetLink");var f=$("[id="+c+"]").attr("data-lockto");var e=$('[data-lockto="'+f+'"]').each(function(){var g=$(this).attr("id");if(preview.linkShowRipple(g,c)){$("#"+g).addClass("widgetLink")}})}})},drawWidgets:function(e,d,c){var h=$("#"+d).find("[data-role=content]");var b=[];for(var g in c.linkDest){if(c.linkType[g]=="template"&&c.linkDest[g]==d){var f=page.get(c.linkOrigin[g],"widgets");b=b.concat(f)}}var f=page.get(d,"widgets");widgetList=b.concat(f);for(var g=0;g<widgetList.length;g++){widget.checkIntegrity(widgetList[g])}if(widgetList.length>0){var a=true;widget.load(d,widgetList,a)}else{preview.showBlankPage(d,c)}},showBlankPage:function(b,a){var c=$("#blankPage").find(".pageList").html();var d=$("#"+b).find(".widgetHolder");d.html(c);d.parent().addClass("blank");$(".blankPageBackButton",d).bind("click",preview.navigateBack)},getPageIdForWidget:function(d){var c=storage.get(g_preview);var a=c.pages;var b="";$.each(a,function(e,f){var g=storage.get(f).widgets;$.each(g,function(i,h){if(h==d){b=f;return false}});if(b!=""){return false}});return b},orient:function(c,b,a){if(!window.g_embedded){try{if(utils.isMobileDevice()){preview._orientMobile(b,a)}else{preview._orientParent(b,a)}preview.scaleViewport(b);preview.centerFrame()}catch(c){}}},_orientationData:function(j){var e=storage.get(g_preview);var g=storage.get(j.attr("id"));var c=e.pageWH||[320,480];var h=g.orientation?(g.orientation!="Landscape"):(g.width<=g.height);var a=h?g.width>g.height:g.width<=g.height;var b=$.event.special.orientationchange;var d=(b&&$.isFunction(b.orientation))?b.orientation()=="portrait":window.screen.width<window.screen.height;var f=c[1]>=c[0];var i=h&&f||!h&&!f;return{portrait:h,crossOriented:d!=h,multiOriented:preview.multiOrientations,projectOriented:i,width:c[0],height:c[1]}},_orientMobile:function(c,a,d){d=d||preview._orientationData(c);preview.pageRotation=d.crossOriented?(d.portrait?-90:90):0;var b;if((d.portrait&&d.projectOriented)||(!d.portrait&&!d.projectOriented)){b="width"}else{b="height"}preview.pageTranslation=preview.pageRotation?(preview.pageRotation>0?[0,-d[b]]:[-d[b],0]):[0,0];preview.applyPageTransforms(c);if(browserDetect.OS=="iOS"){var f=window.screen.width*(preview.viewportScaled?window.devicePixelRatio:1);var g=window.screen.height*(preview.viewportScaled?window.devicePixelRatio:1);var e=d.portrait!=d.crossOriented;$(document.body).css({width:(e?Math.min(f,g):Math.max(f,g))+"px"})}else{if(utils.hideBrowserBar()){window.scrollTo(0,1)}}},orientPrevPage:function(c,a,d){if(!a){return}var b,e=(d.portrait&&d.projectOriented)||(!d.portrait&&!d.projectOriented);translateSide=e?"width":"height";if(d.portrait){b="rotate(90deg) translate(0,-"+d[translateSide]+"px)"}else{b="rotate(-90deg) translate(-"+d[translateSide]+"px, 0)"}$(".widgetHolder",a).css({"-webkit-transform":b,"-moz-transform":b,"transform":b})},_orientParent:function(d,b,f){var g=$("#previewPage",preview.parentWindow?frameElement.ownerDocument:document);f=f||preview._orientationData(d);if(f.crossOriented){if(!preview.parentWindow&&window.g_preview){setTimeout(function(){preview.orientPrevPage(d,b,f)},0)}else{preview.orientPrevPage(d,b,f)}if(g&&g.length){preview.hideNotes();var a=g[0],e=a.parentNode,c={};if(f.projectOriented){c.width=f.width;c.height=f.height}else{c.width=f.height;c.height=f.width}$(".widgetHolder",d).css({"-webkit-transform":"","-moz-transform":"","transform":"","width":c.width+"px","height":c.height+"px"});a.style.width=c.width+"px";a.style.height=c.height+"px";preview.centerFrame(window.parent||window);if(f.portrait){e.classList.remove("to-landscape");e.classList.add("to-portrait")}else{e.classList.remove("to-portrait");e.classList.add("to-landscape")}}else{if(window.parent!==window){preview._crossDomainCall(window.parent,"_orientParent",[null,null,f])}}}fluidEvent.triggerPreview("changeOrientation",{},true)},finishOrient:function(c,b,a){if(!window.g_embedded){try{if(!utils.isMobileDevice()){preview._finishOrient(b,a)}}catch(c){}}},clearPageOrientation:function(){preview.pageRotation=0;preview.pageTranslation=[0,0]},_finishOrient:function(b,a,c){var d=preview.parentWindow&&window.parent&&$("#previewPage",window.parent.document);c=c||preview._orientationData(b);if(preview.parentWindow&&b){preview.multiOrientations=c.multiOriented;preview.updateNotes(b[0].id);preview.positionNotes();preview.showNotes()}if(a){preview.clearPageOrientation();a.find(".widgetHolder").css({transform:"",webkitTransform:"",mosTransform:""});preview.clearPageOrientation();preview._crossDomainCall(window.parent,"_finishOrient",[null,null,c])}},bindMobileEvents:function(h){scrollview.setup(h);function d(k,j){preview.pageTransitioning=true;scrollview.showPage.call(k.target,k)}function b(k,j){scrollview.isScrolling=false;scrollview.isDoubleTapping=false;scrollview.isSwiping=false;preview.pageTransitioning=false;preview.finishOrient(k,$(k.target),j.prevPage);$(".ui-scrollview-clip",k.target).scrollview("option","rotate",preview.pageRotation);if(window.g_imgExport=="true"){k.stopImmediatePropagation()}setTimeout(function(){scrollview.isTapHolding=false;if(utils.hideBrowserBar()){window.scrollTo(0,1)}},350)}function g(j){preview.orient(j,$.mobile.activePage);$(".ui-scrollview-clip",$.mobile.activePage).scrollview("option","rotate",preview.pageRotation)}function e(n){scrollview.isScrolling=false;scrollview.isDoubleTapping=false;scrollview.isTapHolding=false;scrollview.isSwiping=true;var k={"up":0,"right":90,"down":180,"left":270};var j={0:"up",90:"right",180:"down",270:"left"};var m=n.type.substr(5);var l=j[(360+(k[m]-preview.pageRotation))%360];preview.handleUserInput("swipe"+l,$(n.currentTarget).attr("id"),h);return false}function a(j){j.stopImmediatePropagation();if(scrollview.isSwiping){scrollview.isSwiping=false}else{if(scrollview.isScrolling){scrollview.isScrolling=false}else{if(scrollview.isDoubleTapping){scrollview.isDoubleTapping=false}else{if(scrollview.isTapHolding){scrollview.isTapHolding=false}else{preview.handleUserInput(j.type,$(j.currentTarget).attr("id"),h)}}}}}function i(k){scrollview.isTapHolding=true;var j=$(k.currentTarget).attr("id");preview.handleUserInput(k.type,j,h)}function f(k){scrollview.isDoubleTapping=true;var j=$(k.target).parents(".pageWidget").attr("id");preview.handleUserInput("doubletap",j,h)}function c(j){$(document).trigger("mouseup")}if(utils.isMobileDevice()){if($.support.orientation){$(window).bind("orientationchange",g)}$(window).resize(function(){window.setTimeout(function(){preview.scaleViewport($.mobile.activePage)},100)})}$("body").bind("pageinit",function(j){$(".pageWidget",j.target).doubletap(f)}).bind("pagebeforeshow",d).bind("pageshow",b).mouseleave(c);$(document).bind("touchmove",false);$(".pageWidget").live("swipeleft swiperight swipeup swipedown",e).live("vclick",function(j){j.preventDefault();a(j)}).live("taphold",i)},handleUserInput:function(d,f,b){var e=preview.parentWindow&&preview.parentWindow.fluid?preview.parentWindow.fluid.main.project:fluid.main.project;var b=e.get("links");if(scrollview.isScrolling){return false}d=(d=="vclick"||d=="click")?"tap":d;var a=preview.linkCheck(f,b);if(a>-1&&b.triggerType[a]==d){preview.navigateSetIncompleted();var g=e.links.get(b.linkCanvId[a]).get("transType").split(":");var c=(g.length>1)?true:false;preview.changePage("#"+b.linkDest[a],{transition:g[0],reverse:c})}else{}},alertCopyEmbedCode:function(a){notification.add("alert","Embed Code Copied");tracker.record("copiedEmbedCode",5,"",a)},showDebugInfo:function(b){var a=$("#divDebugInfo").html();if(a){b=a+b}$("#divDebugInfo").remove();$("body").append("<div id='divDebugInfo'>"+b+"<br/></div>")},getTrueHeight:function(){return(window.hasOwnProperty("innerHeight")?window.innerHeight:$(window).height())||480},linkCheck:function(c,a){do{var b=$.inArray(c,a.linkOrigin);if(b>-1){return b}c=storage.get(c);if(c==null){return -1}c=c.of}while(c);return -1},linkShowRipple:function(c,b){var a=storage.get(c);if(a&&a.segments==null){if(a.of==null){return}if(b!=a.of){if(preview.linkShowRipple(a.of,b)){$("#"+c).addClass("widgetLink")}}if(b==a.of){return true}}},runDraw:function(l){var b=l;var e;if(typeof(l)=="string"){l=project.bundle(l);e=l[g_preview];if(!e||!e.pages){ajax.syncDown(b,preview.parseDownload);return}}e=e||l[window.g_preview];preview.loaded=true;preview.navigationStackBack=[];preview.navigationStackForward=[];preview.navigationQueueNext=[];preview.navigationQueueFlow=[];preview.navigationCompleted=false;preview.navigationDefaultTransition=e?e.defaultTransition:"none";preview.draw(l);if(window.g_print){var j=20,c=e.pageWH[0];height=e.pageWH[1],printStyle="@page { size: "+e.orientation+"; margin: "+j+"px; }\n"+".printPageWrapper { width: "+c+"px; height: "+height+" }\n";for(var f=1;f>0;f-=0.1){f=f.toFixed(1);var h=Math.floor(c*f),a=Math.floor(height*f);printStyle+="@media print and (max-width: "+(h+j)+"px) {\n"+"    .project-size .page { -webkit-transform: scale("+f+"); transform: scale("+f+"); }\n"+"    .printPageWrapper.project-size { width: "+h+"px; height: "+a+"px}\n"+"}\n"}for(var g=0;g<e.pages.length;g++){var d=e.pages[g],k=l[d];if(k.width===c&&k.height===height){continue}printStyle+="#print_"+d+" { width: "+k.width+"px; height: "+k.height+"px; }\n";for(var f=1;f>0;f=f-=0.1){f=f.toFixed(1);var h=Math.floor(k.width*f),a=Math.floor(k.height*f);printStyle+="@media print and (max-width: "+(h+j)+"px) {\n"+"    #"+d+" { -webkit-transform: scale("+f+"); transform: scale("+f+"); }\n"+"    #print_"+d+" { width: "+h+"px; height: "+a+"px; }\n"+"}\n"}}$("head").append('<style type="text/css">'+printStyle+"</style>")}},restart:function(){preview.changePage("#"+preview.homePage,null,false,true)},hideMenu:function(){},navigateInit:function(b,a){preview.navigationEnabled=true},navigateSetCompleted:function(){preview.navigationQueueNext=[];preview.navigationStackForward=[];preview.navigationCompleted=true},navigateSetIncompleted:function(){preview.navigationCompleted=false},navigateWithKeys:function(c){if((c.keyCode==27)&&(self!=top)&&(window.parent.lib!=undefined)){window.parent.lib.esc()}var b=utils.getNavigationKeyDirection(c.keyCode);if(b==""){return}var a=top==self?document.getElementById("previewPage").contentWindow.preview:window.preview;if((!a)||(!a.navigationEnabled)){return}if((b=="top")||(b=="right")){a.navigateNext();return}a.navigateBack()},navigateNext:function(){if(preview.navigationStackForward.length>0){var a=preview.navigationStackForward.pop();preview.changePage("#"+a.pageId,a.args);return}if(preview.navigationQueueNext.length>0){var a=preview.navigationQueueNext.shift();preview.changePage("#"+a.pageId,a.args);return}if(preview.navigationQueueFlow.length>0){var a=preview.navigationQueueFlow.shift();preview.changePage("#"+a.pageId,a.args);return}},navigateBack:function(){if(preview.navigationStackBack.length>1){var g=preview.navigationStackBack.pop();var f=preview.navigationStackBack.pop();var a=$("#"+f.pageId).hasClass("blank");if(a){if(preview.navigationStackBack.length>0){f=preview.navigationStackBack.pop()}else{return}}if(preview.navigationCompleted){var e=preview.navigationQueueFlow.pop();preview.navigationQueueFlow.splice(0,0,e);var b=preview.navigationQueueFlow.pop();if(b.pageId!=f.pageId){preview.navigationQueueFlow.push(b)}}else{preview.navigationStackForward=$.grep(preview.navigationStackForward,function(j,h){return j.pageId!=g.pageId});var d=$("#"+g.pageId).hasClass("blank");if(!d){var c={pageId:g.pageId,args:f.args};preview.navigationStackForward.push(c)}}preview.changePage("#"+f.pageId,f.args,1);return}if((preview.navigationCompleted)&&(preview.navigationQueueFlow.length>0)){var e=preview.navigationQueueFlow.pop();preview.changePage("#"+e.pageId,e.args,1)}},_crossDomainCall:function(c,b,a){c.postMessage(JSON.stringify({funcName:b,args:a}),"*")},_crossDomainCallListener:function(a){var b=JSON.parse(a.originalEvent.data);if($.isFunction(preview[b.funcName])){preview[b.funcName].apply(preview,b.args)}},getNotesElement:function(c){c=c||window;var b=c.document.getElementById("inPreviewNotes");if(b){return b}try{if(c.frameElement){return preview.getNotesElement(c.frameElement.ownerDocument.defaultView)}}catch(a){}return null},positionNotes:function(){var b=preview.getNotesElement(),c=b&&b.clientWidth||0;if(b){var d=document.getElementById("previewPage")||window.frameElement,a=d.getClientRects()[0];if(!a){return}x=a.left;y=a.top;b.style.left=(x-c+1)+"px";b.style.top=Math.max(y,0)+"px"}},updateNotes:function(a){var b=preview.getNotesElement();if(!b){return}var d=preview.getNotesElement().querySelector("#previewNotesContent"),c=page.get(a,"notes");d.textContent=c&&c[3]||"This page has no notes"},showNotes:function(){notesElement=preview.getNotesElement();notesElement&&notesElement.classList.remove("hide")},hideNotes:function(){notesElement=preview.getNotesElement();notesElement&&notesElement.classList.add("hide")},toggleShare:function(){var a=document.getElementById("previewShare");a.classList.toggle("closed");preview.setAvailableRect(preview.calcAvailableRect());preview.scaleFrame()},centerFrame:function(d){d=d||preview.parentWindow||window;var h=d.document,c=h.getElementById("previewPage");if(!c){preview._crossDomainCall(window.parent,"centerFrame");return}var f=c.parentNode,i=f.style,b=preview.availableRect,a=$(c).outerWidth(),j=$(c).outerHeight(),e=b.width/2+b.left,g=b.height/2+b.top;i.marginLeft=-(a/2)+"px";i.marginTop=-(j/2)+"px";i.left="50%";i.top="50%";i.width=a+"px";i.height=j+"px";setTimeout(preview.positionNotes,400)},calcAvailableRect:function(a){a=a||window;var b=a.document;return{width:a.innerWidth,height:a.innerHeight,left:0,top:0}},setFrameSize:function(b,a){$("#previewPage").css({width:b,height:a});preview.scaleFrame()},availableRect:{width:(location.origin==="file://")?window.innerWidth:top.innerWidth,height:(location.origin==="file://")?window.innerHeight:top.innerHeight,top:0,left:0},setAvailableRect:function(a){a=a||preview.calcAvailableRect();preview.availableRect=a;if(preview.canAccessFrame()&&$("#previewPage")[0].contentWindow.preview){$("#previewPage")[0].contentWindow.preview.availableRect=a}else{if($("#previewPage").length){preview._crossDomainCall($("#previewPage")[0].contentWindow,"setAvailableRect",a)}}},canAccessFrame:function(){try{return !!(document.getElementById("previewPage").contentWindow.document)}catch(a){return false}}};(function(){var d=j(function(){preview.positionNotes();preview.showNotes()},400),e=null,b={menuElement:null,isOpen:a,toggle:g,open:f,close:k,debouncePositionNotes:d,width:0},i=300,c=null,h=null;function a(){return !e.classList.contains("closed")}function g(){e.classList.toggle("closed")}function f(){if(!a()){g()}}function k(){if(a()){g()}}function j(p,s,m){var r,n,o,q,l;return function(){o=this;n=arguments;q=new Date();var u=function(){var v=(new Date())-q;if(v<s){r=setTimeout(u,s-v)}else{r=null;if(!m){l=p.apply(o,n)}}};var t=m&&!r;if(!r){r=setTimeout(u,s)}if(t){l=p.apply(o,n)}return l}}document.addEventListener("DOMContentLoaded",function(){e=b.menuElement=document.getElementById("previewMenu");if(!e){return}c=document.getElementById("previewPage");h=c.contentWindow;$(".show-notes-icon").children().eq(1).hide();if(c){c.addEventListener("load",function(){h=c.contentWindow;if(e.querySelector("#previewShowLinks").checked){h.document.body.classList.add("highlight-links")}})}document.getElementById("restartPreview").addEventListener("click",function(o){if(h&&h.preview){h.preview.restart()}});function l(o,p){c.style.webkitTransform=c.style.mozTransform=c.style.transform="scale("+p.value+")";h.preview.useZoomSlider=true;preview.pageScale=p.value;preview.hideNotes();d()}function n(o,p){$("#previewPage").addClass("user-scaling")}function m(o,p){$("#previewPage").removeClass("user-scaling")}$("#previewZoomSlider").slider({range:"min",min:0.05,max:4,step:0.01,start:n,slide:l,change:m,stop:m});document.getElementById("previewShowLinks").addEventListener("change",function(o){if(h){if(o.target.checked){h.document.body.classList.add("highlight-links")}else{h.document.body.classList.remove("highlight-links")}}});document.getElementById("previewShowNotes").addEventListener("change",function(o){if(o.target.checked){preview.getNotesElement().style.display="";$(".show-notes-icon").children().eq(0).hide().next().show();preview.positionNotes()}else{preview.getNotesElement().style.display="none";$(".show-notes-icon").children().eq(0).show().next().hide()}});document.getElementById("previewBestFit").addEventListener("click",function(o){h.preview.useZoomSlider=false;preview.hideNotes();d();preview.scaleFrame();$("#previewZoomSlider").slider("value",preview.currentFrameScale)});document.getElementById("previewFullscreen").addEventListener("click",function(o){h.preview.useZoomSlider=false;preview.hideNotes();d();preview.scaleFrame(undefined,undefined,true);$("#previewZoomSlider").slider("value",preview.currentFrameScale)});document.addEventListener("click",function(o){if(!$(o.target).is("#previewMenu, #previewMenu *, #togglePreviewMenu, #togglePreviewMenu *")){k()}})});window.previewMenu=b}());var fluidEvent={lastEvent:"",lastTrigger:new Date().getTime(),triggerEditor:function(a,c,b){fluidEvent._trigger($("#canvas"),a,c,b)},bindEditor:function(a,b){fluidEvent._bind($("#canvas"),a,b)},triggerPreview:function(a,c,b){fluidEvent._trigger($("#home"),a,c,b)},_trigger:function(d,a,f,e){var c=false;var b=new Date().getTime();var g=e||false;if((fluidEvent.lastEvent!=a)||(b-fluidEvent.lastTrigger>500)||g){c=true}if(c){d.trigger(a,f);fluidEvent.lastEvent=a;fluidEvent.lastTrigger=b}},_bind:function(b,a,c){b.live(a,c)}};jQuery.fn.liveDraggable=function(a){this.live("mouseover",function(){if(!$(this).data("initDraggable")){var b=$(this).hasClass("screen")&&$(this).hasClass("active");if(!fluid.zoom.isEditMode()||(!b)||((b)&&($(this).data("initSelectable")))){$(this).data("initDraggable",true).draggable(a)}canvas2.setPageContainment(this)}});return $(this)};jQuery.fn.liveSelectable=function(a){this.live("mouseover",function(){if(!project.readOnly()&&!$(this).data("initSelectable")){$(this).data("initSelectable",true).selectable(a)}});return $(this)};
/*

JSZip - A Javascript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2012 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.

JSZip uses the library zlib.js released under the following license :
zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License
*/
!function(b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define(b):"undefined"!=typeof window?window.JSZip=b():"undefined"!=typeof global?global.JSZip=b():"undefined"!=typeof self&&(self.JSZip=b())}(function(){return function b(a,l,k){function j(f,e){if(!l[f]){if(!a[f]){var d="function"==typeof require&&require;if(!e&&d){return d(f,!0)}if(i){return i(f,!0)}throw new Error("Cannot find module '"+f+"'")}var c=l[f]={exports:{}};a[f][0].call(c.exports,function(g){var m=a[f][1][g];return j(m?m:g)},c,c.exports,b,a,l,k)}return l[f].exports}for(var i="function"==typeof require&&require,h=0;h<k.length;h++){j(k[h])}return j}({1:[function(f,e,h){var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";h.encode=function(t){for(var s,r,q,p,o,n,m,l="",d=0;d<t.length;){s=t.charCodeAt(d++),r=t.charCodeAt(d++),q=t.charCodeAt(d++),p=s>>2,o=(3&s)<<4|r>>4,n=(15&r)<<2|q>>6,m=63&q,isNaN(r)?n=m=64:isNaN(q)&&(m=64),l=l+g.charAt(p)+g.charAt(o)+g.charAt(n)+g.charAt(m)}return l},h.decode=function(t){var s,r,q,p,o,n,m,l="",d=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");d<t.length;){p=g.indexOf(t.charAt(d++)),o=g.indexOf(t.charAt(d++)),n=g.indexOf(t.charAt(d++)),m=g.indexOf(t.charAt(d++)),s=p<<2|o>>4,r=(15&o)<<4|n>>2,q=(3&n)<<6|m,l+=String.fromCharCode(s),64!=n&&(l+=String.fromCharCode(r)),64!=m&&(l+=String.fromCharCode(q))}return l}},{}],2:[function(e,d){function f(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}f.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},d.exports=f},{}],3:[function(e,d,f){f.STORE={magic:"\x00\x00",compress:function(c){return c},uncompress:function(c){return c},compressInputType:null,uncompressInputType:null},f.DEFLATE=e("./flate")},{"./flate":6}],4:[function(f,e){function h(){this.data=null,this.length=0,this.index=0}var g=f("./utils");h.prototype={checkOffset:function(c){this.checkIndex(this.index+c)},checkIndex:function(c){if(this.length<c||0>c){throw new Error("End of data reached (data length = "+this.length+", asked index = "+c+"). Corrupted zip ?")}},setIndex:function(c){this.checkIndex(c),this.index=c},skip:function(c){this.setIndex(this.index+c)},byteAt:function(){},readInt:function(i){var d,j=0;for(this.checkOffset(i),d=this.index+i-1;d>=this.index;d--){j=(j<<8)+this.byteAt(d)}return this.index+=i,j},readString:function(c){return g.transformTo("string",this.readData(c))},readData:function(){},lastIndexOfSignature:function(){},readDate:function(){var c=this.readInt(4);return new Date((c>>25&127)+1980,(c>>21&15)-1,c>>16&31,c>>11&31,c>>5&63,(31&c)<<1)}},e.exports=h},{"./utils":14}],5:[function(e,d,f){f.base64=!1,f.binary=!1,f.dir=!1,f.date=null,f.compression=null},{}],6:[function(h,g,l){var k="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,j=h("zlibjs/bin/rawdeflate.min").Zlib,i=h("zlibjs/bin/rawinflate.min").Zlib;l.uncompressInputType=k?"uint8array":"array",l.compressInputType=k?"uint8array":"array",l.magic="\b\x00",l.compress=function(d){var c=new j.RawDeflate(d);return c.compress()},l.uncompress=function(d){var c=new i.RawInflate(d);return c.decompress()}},{"zlibjs/bin/rawdeflate.min":19,"zlibjs/bin/rawinflate.min":20}],7:[function(e,d){function f(g,c){this.files={},this.root="",g&&this.load(g,c),this.clone=function(){var i=new f;for(var h in this){"function"!=typeof this[h]&&(i[h]=this[h])}return i}}f.prototype=e("./object"),f.prototype.load=e("./load"),f.support=e("./support"),f.defaults=e("./defaults"),f.utils=e("./utils"),f.base64=e("./base64"),f.compressions=e("./compressions"),d.exports=f},{"./base64":1,"./compressions":3,"./defaults":5,"./load":8,"./object":9,"./support":12,"./utils":14}],8:[function(f,e){var h=f("./base64"),g=f("./zipEntries");e.exports=function(d,c){var l,k,j,i;for(c=c||{},c.base64&&(d=h.decode(d)),k=new g(d,c),l=k.files,j=0;j<l.length;j++){i=l[j],this.file(i.fileName,i.decompressed,{binary:!0,optimizedBinaryString:!0,date:i.date,dir:i.dir})}return this}},{"./base64":1,"./zipEntries":15}],9:[function(ab,aa){var Z,Y,X=ab("./support"),W=ab("./utils"),V=ab("./signature"),U=ab("./defaults"),T=ab("./base64"),S=ab("./compressions"),R=ab("./compressedObject"),Q=ab("./nodeBuffer");X.uint8array&&"function"==typeof TextEncoder&&"function"==typeof TextDecoder&&(Z=new TextEncoder("utf-8"),Y=new TextDecoder("utf-8"));var P=function(d){if(d._data instanceof R&&(d._data=d._data.getContent(),d.options.binary=!0,d.options.base64=!1,"uint8array"===W.getTypeOf(d._data))){var c=d._data;d._data=new Uint8Array(c.length),0!==c.length&&d._data.set(c,0)}return d._data},O=function(e){var c=P(e),f=W.getTypeOf(c);if("string"===f){if(!e.options.binary){if(Z){return Z.encode(c)}if(X.nodebuffer){return Q(c,"utf-8")}}return e.asBinary()}return c},N=function(d){var c=P(this);return null===c||"undefined"==typeof c?"":(this.options.base64&&(c=T.decode(c)),c=d&&this.options.binary?L.utf8decode(c):W.transformTo("string",c),d||this.options.binary||(c=L.utf8encode(c)),c)},M=function(e,d,f){this.name=e,this._data=d,this.options=f};M.prototype={asText:function(){return N.call(this,!0)},asBinary:function(){return N.call(this,!1)},asNodeBuffer:function(){var c=O(this);return W.transformTo("nodebuffer",c)},asUint8Array:function(){var c=O(this);return W.transformTo("uint8array",c)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var K=function(f,e){var h,g="";for(h=0;e>h;h++){g+=String.fromCharCode(255&f),f>>>=8}return g},J=function(){var e,d,f={};for(e=0;e<arguments.length;e++){for(d in arguments[e]){arguments[e].hasOwnProperty(d)&&"undefined"==typeof f[d]&&(f[d]=arguments[e][d])}}return f},I=function(c){return c=c||{},c.base64!==!0||null!==c.binary&&void 0!==c.binary||(c.binary=!0),c=J(c,U),c.date=c.date||new Date,null!==c.compression&&(c.compression=c.compression.toUpperCase()),c},H=function(h,f,l){var k=G(h),j=W.getTypeOf(f);if(k&&F.call(this,k),l=I(l),l.dir||null===f||"undefined"==typeof f){l.base64=!1,l.binary=!1,f=null}else{if("string"===j){l.binary&&!l.base64&&l.optimizedBinaryString!==!0&&(f=W.string2binary(f))}else{if(l.base64=!1,l.binary=!0,!(j||f instanceof R)){throw new Error("The data of '"+h+"' is in an unsupported format !")}"arraybuffer"===j&&(f=W.transformTo("uint8array",f))}}var i=new M(h,f,l);return this.files[h]=i,i},G=function(d){"/"==d.slice(-1)&&(d=d.substring(0,d.length-1));var c=d.lastIndexOf("/");return c>0?d.substring(0,c):""},F=function(c){return"/"!=c.slice(-1)&&(c+="/"),this.files[c]||H.call(this,c,null,{dir:!0}),this.files[c]},E=function(f,e){var h,g=new R;return f._data instanceof R?(g.uncompressedSize=f._data.uncompressedSize,g.crc32=f._data.crc32,0===g.uncompressedSize||f.options.dir?(e=S.STORE,g.compressedContent="",g.crc32=0):f._data.compressionMethod===e.magic?g.compressedContent=f._data.getCompressedContent():(h=f._data.getContent(),g.compressedContent=e.compress(W.transformTo(e.compressInputType,h)))):(h=O(f),(!h||0===h.length||f.options.dir)&&(e=S.STORE,h=""),g.uncompressedSize=h.length,g.crc32=this.crc32(h),g.compressedContent=e.compress(W.transformTo(e.compressInputType,h))),g.compressedSize=g.compressedContent.length,g.compressionMethod=e.magic,g},D=function(ae,ad,ac,A){var z,w,v=(ac.compressedContent,this.utf8encode(ad.name)),u=v!==ad.name,t=ad.options,s="",r="";z=t.date.getHours(),z<<=6,z|=t.date.getMinutes(),z<<=5,z|=t.date.getSeconds()/2,w=t.date.getFullYear()-1980,w<<=4,w|=t.date.getMonth()+1,w<<=5,w|=t.date.getDate(),u&&(r=K(1,1)+K(this.crc32(v),4)+v,s+="up"+K(r.length,2)+r);var q="";q+="\n\x00",q+=u?"\x00\b":"\x00\x00",q+=ac.compressionMethod,q+=K(z,2),q+=K(w,2),q+=K(ac.crc32,4),q+=K(ac.compressedSize,4),q+=K(ac.uncompressedSize,4),q+=K(v.length,2),q+=K(s.length,2);var p=V.LOCAL_FILE_HEADER+q+v+s,g=V.CENTRAL_FILE_HEADER+"\x00"+q+"\x00\x00\x00\x00\x00\x00"+(ad.options.dir===!0?"\x00\x00\x00":"\x00\x00\x00\x00")+K(A,4)+v+s;return{fileRecord:p,dirRecord:g,compressedObject:ac}},C=function(){this.data=[]};C.prototype={append:function(c){c=W.transformTo("string",c),this.data.push(c)},finalize:function(){return this.data.join("")}};var B=function(c){this.data=new Uint8Array(c),this.index=0};B.prototype={append:function(c){0!==c.length&&(c=W.transformTo("uint8array",c),this.data.set(c,this.index),this.index+=c.length)},finalize:function(){return this.data}};var L={load:function(){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(h){var g,l,k,j,i=[];for(g in this.files){this.files.hasOwnProperty(g)&&(k=this.files[g],j=new M(k.name,k._data,J(k.options)),l=g.slice(this.root.length,g.length),g.slice(0,this.root.length)===this.root&&h(l,j)&&i.push(j))}return i},file:function(f,e,h){if(1===arguments.length){if(W.isRegExp(f)){var g=f;return this.filter(function(d,c){return !c.options.dir&&g.test(d)})}return this.filter(function(a,d){return !d.options.dir&&a===f})[0]||null}return f=this.root+f,H.call(this,f,e,h),this},folder:function(f){if(!f){return this}if(W.isRegExp(f)){return this.filter(function(a,d){return d.options.dir&&f.test(a)})}var e=this.root+f,h=F.call(this,e),g=this.clone();return g.root=h.name,g},remove:function(f){f=this.root+f;var e=this.files[f];if(e||("/"!=f.slice(-1)&&(f+="/"),e=this.files[f]),e){if(e.options.dir){for(var h=this.filter(function(a,d){return d.name.slice(0,f.length)===f}),g=0;g<h.length;g++){delete this.files[h[g].name]}}else{delete this.files[f]}}return this},generate:function(ad){ad=J(ad||{},{base64:!0,compression:"STORE",type:"base64"}),W.checkSupport(ad.type);var ac,A,z=[],w=0,v=0;for(var r in this.files){if(this.files.hasOwnProperty(r)){var q=this.files[r],j=q.options.compression||ad.compression.toUpperCase(),i=S[j];if(!i){throw new Error(j+" is not a valid compression method !")}var g=E.call(this,q,i),f=D.call(this,r,q,g,w);w+=f.fileRecord.length+g.compressedSize,v+=f.dirRecord.length,z.push(f)}}var ag="";ag=V.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+K(z.length,2)+K(z.length,2)+K(v,4)+K(w,4)+"\x00\x00";var af=ad.type.toLowerCase();for(ac="uint8array"===af||"arraybuffer"===af||"blob"===af||"nodebuffer"===af?new B(w+v+ag.length):new C(w+v+ag.length),A=0;A<z.length;A++){ac.append(z[A].fileRecord),ac.append(z[A].compressedObject.compressedContent)}for(A=0;A<z.length;A++){ac.append(z[A].dirRecord)}ac.append(ag);var ae=ac.finalize();switch(ad.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return W.transformTo(ad.type.toLowerCase(),ae);case"blob":return W.arrayBuffer2Blob(W.transformTo("arraybuffer",ae));case"base64":return ad.base64?T.encode(ae):ae;default:return ae}},crc32:function(r,q){if("undefined"==typeof r||!r.length){return 0}var p="string"!==W.getTypeOf(r),o=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918000,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"==typeof q&&(q=0);var n=0,m=0,l=0;q=-1^q;for(var k=0,f=r.length;f>k;k++){l=p?r[k]:r.charCodeAt(k),m=255&(q^l),n=o[m],q=q>>>8^n}return -1^q},utf8encode:function(e){if(Z){var c=Z.encode(e);return W.transformTo("string",c)}if(X.nodebuffer){return W.transformTo("string",Q(e,"utf-8"))}for(var l=[],k=0,j=0;j<e.length;j++){var f=e.charCodeAt(j);128>f?l[k++]=String.fromCharCode(f):f>127&&2048>f?(l[k++]=String.fromCharCode(f>>6|192),l[k++]=String.fromCharCode(63&f|128)):(l[k++]=String.fromCharCode(f>>12|224),l[k++]=String.fromCharCode(f>>6&63|128),l[k++]=String.fromCharCode(63&f|128))}return l.join("")},utf8decode:function(r){var q=[],p=0,o=W.getTypeOf(r),n="string"!==o,m=0,f=0,e=0,d=0;if(Y){return Y.decode(W.transformTo("uint8array",r))}if(X.nodebuffer){return W.transformTo("nodebuffer",r).toString("utf-8")}for(;m<r.length;){f=n?r[m]:r.charCodeAt(m),128>f?(q[p++]=String.fromCharCode(f),m++):f>191&&224>f?(e=n?r[m+1]:r.charCodeAt(m+1),q[p++]=String.fromCharCode((31&f)<<6|63&e),m+=2):(e=n?r[m+1]:r.charCodeAt(m+1),d=n?r[m+2]:r.charCodeAt(m+2),q[p++]=String.fromCharCode((15&f)<<12|(63&e)<<6|63&d),m+=3)}return q.join("")}};aa.exports=L},{"./base64":1,"./compressedObject":2,"./compressions":3,"./defaults":5,"./nodeBuffer":17,"./signature":10,"./support":12,"./utils":14}],10:[function(e,d,f){f.LOCAL_FILE_HEADER="PK",f.CENTRAL_FILE_HEADER="PK",f.CENTRAL_DIRECTORY_END="PK",f.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",f.ZIP64_CENTRAL_DIRECTORY_END="PK",f.DATA_DESCRIPTOR="PK\b"},{}],11:[function(g,f){function j(d,c){this.data=d,c||(this.data=h.string2binary(this.data)),this.length=this.data.length,this.index=0}var i=g("./dataReader"),h=g("./utils");j.prototype=new i,j.prototype.byteAt=function(c){return this.data.charCodeAt(c)},j.prototype.lastIndexOfSignature=function(c){return this.data.lastIndexOf(c)},j.prototype.readData=function(d){this.checkOffset(d);var c=this.data.slice(this.index,this.index+d);return this.index+=d,c},f.exports=j},{"./dataReader":4,"./utils":14}],12:[function(j,i,p){var o=j("__browserify_process");if(p.base64=!0,p.array=!0,p.string=!0,p.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,p.nodebuffer=!o.browser,p.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer){p.blob=!1}else{var n=new ArrayBuffer(0);try{p.blob=0===new Blob([n],{type:"application/zip"}).size}catch(m){try{var l=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,k=new l;k.append(n),p.blob=0===k.getBlob("application/zip").size}catch(m){p.blob=!1}}}},{__browserify_process:18}],13:[function(f,e){function h(c){c&&(this.data=c,this.length=this.data.length,this.index=0)}var g=f("./dataReader");h.prototype=new g,h.prototype.byteAt=function(c){return this.data[c]},h.prototype.lastIndexOfSignature=function(j){for(var i=j.charCodeAt(0),n=j.charCodeAt(1),m=j.charCodeAt(2),l=j.charCodeAt(3),k=this.length-4;k>=0;--k){if(this.data[k]===i&&this.data[k+1]===n&&this.data[k+2]===m&&this.data[k+3]===l){return k}}return -1},h.prototype.readData=function(d){this.checkOffset(d);var c=this.data.subarray(this.index,this.index+d);return this.index+=d,c},e.exports=h},{"./dataReader":4}],14:[function(v,u,t){function s(c){return c}function r(e,d){for(var f=0;f<e.length;++f){d[f]=255&e.charCodeAt(f)}return d}function q(F){var E=65536,D=[],C=F.length,B=t.getTypeOf(F),A=0,z=!0;try{switch(B){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,m(0))}}catch(w){z=!1}if(!z){for(var j="",c=0;c<F.length;c++){j+=String.fromCharCode(F[c])}return j}for(;C>A&&E>1;){try{D.push("array"===B||"nodebuffer"===B?String.fromCharCode.apply(null,F.slice(A,Math.min(A+E,C))):String.fromCharCode.apply(null,F.subarray(A,Math.min(A+E,C)))),A+=E}catch(w){E=Math.floor(E/2)}}return D.join("")}function p(e,d){for(var f=0;f<e.length;f++){d[f]=e[f]}return d}var o=v("./support"),n=v("./compressions"),m=v("./nodeBuffer");t.string2binary=function(e){for(var d="",f=0;f<e.length;f++){d+=String.fromCharCode(255&e.charCodeAt(f))}return d},t.string2Uint8Array=function(c){return t.transformTo("uint8array",c)},t.uint8Array2String=function(c){return t.transformTo("string",c)},t.string2Blob=function(d){var c=t.transformTo("arraybuffer",d);return t.arrayBuffer2Blob(c)},t.arrayBuffer2Blob=function(f){t.checkSupport("blob");try{return new Blob([f],{type:"application/zip"})}catch(c){try{var h=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,g=new h;return g.append(f),g.getBlob("application/zip")}catch(c){throw new Error("Bug : can't construct the Blob.")}}};var l={};l.string={string:s,array:function(c){return r(c,new Array(c.length))},arraybuffer:function(c){return l.string.uint8array(c).buffer},uint8array:function(c){return r(c,new Uint8Array(c.length))},nodebuffer:function(c){return r(c,m(c.length))}},l.array={string:q,array:s,arraybuffer:function(c){return new Uint8Array(c).buffer},uint8array:function(c){return new Uint8Array(c)},nodebuffer:function(c){return m(c)}},l.arraybuffer={string:function(c){return q(new Uint8Array(c))},array:function(c){return p(new Uint8Array(c),new Array(c.byteLength))},arraybuffer:s,uint8array:function(c){return new Uint8Array(c)},nodebuffer:function(c){return m(new Uint8Array(c))}},l.uint8array={string:q,array:function(c){return p(c,new Array(c.length))},arraybuffer:function(c){return c.buffer},uint8array:s,nodebuffer:function(c){return m(c)}},l.nodebuffer={string:q,array:function(c){return p(c,new Array(c.length))},arraybuffer:function(c){return l.nodebuffer.uint8array(c).buffer},uint8array:function(c){return p(c,new Uint8Array(c.length))},nodebuffer:s},t.transformTo=function(f,c){if(c||(c=""),!f){return c}t.checkSupport(f);var h=t.getTypeOf(c),g=l[h][f](c);return g},t.getTypeOf=function(c){return"string"==typeof c?"string":"[object Array]"===Object.prototype.toString.call(c)?"array":o.nodebuffer&&m.test(c)?"nodebuffer":o.uint8array&&c instanceof Uint8Array?"uint8array":o.arraybuffer&&c instanceof ArrayBuffer?"arraybuffer":void 0},t.checkSupport=function(d){var c=o[d.toLowerCase()];if(!c){throw new Error(d+" is not supported by this browser")}},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(f){var e,h,g="";for(h=0;h<(f||"").length;h++){e=f.charCodeAt(h),g+="\\x"+(16>e?"0":"")+e.toString(16).toUpperCase()}return g},t.findCompression=function(d){for(var c in n){if(n.hasOwnProperty(c)&&n[c].magic===d){return n[c]}}return null},t.isRegExp=function(c){return"[object RegExp]"===Object.prototype.toString.call(c)}},{"./compressions":3,"./nodeBuffer":17,"./support":12}],15:[function(t,s){function r(d,c){this.files=[],this.loadOptions=c,d&&this.load(d)}var q=t("./stringReader"),p=t("./nodeBufferReader"),o=t("./uint8ArrayReader"),n=t("./utils"),m=t("./signature"),l=t("./zipEntry"),k=t("./support");r.prototype={checkSignature:function(d){var c=this.reader.readString(4);if(c!==d){throw new Error("Corrupted zip or bug : unexpected signature ("+n.pretty(c)+", expected "+n.pretty(d)+")")}},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,f,j,i=this.zip64EndOfCentralSize-44,h=0;i>h;){g=this.reader.readInt(2),f=this.reader.readInt(4),j=this.reader.readString(f),this.zip64ExtensibleData[g]={id:g,length:f,value:j}}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1){throw new Error("Multi-volumes zip are not supported")}},readLocalFiles:function(){var d,c;for(d=0;d<this.files.length;d++){c=this.files[d],this.reader.setIndex(c.localHeaderOffset),this.checkSignature(m.LOCAL_FILE_HEADER),c.readLocalPart(this.reader),c.handleUTF8()}},readCentralDir:function(){var c;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===m.CENTRAL_FILE_HEADER;){c=new l({zip64:this.zip64},this.loadOptions),c.readCentralPart(this.reader),this.files.push(c)}},readEndOfCentral:function(){var c=this.reader.lastIndexOfSignature(m.CENTRAL_DIRECTORY_END);if(-1===c){throw new Error("Corrupted zip : can't find end of central directory")}if(this.reader.setIndex(c),this.checkSignature(m.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,c=this.reader.lastIndexOfSignature(m.ZIP64_CENTRAL_DIRECTORY_LOCATOR),-1===c){throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator")}this.reader.setIndex(c),this.checkSignature(m.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(m.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(d){var c=n.getTypeOf(d);this.reader="string"!==c||k.uint8array?"nodebuffer"===c?new p(d):new o(n.transformTo("uint8array",d)):new q(d,this.loadOptions.optimizedBinaryString)},load:function(c){this.prepareReader(c),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},s.exports=r},{"./nodeBufferReader":17,"./signature":10,"./stringReader":11,"./support":12,"./uint8ArrayReader":13,"./utils":14,"./zipEntry":16}],16:[function(i,h){function n(d,c){this.options=d,this.loadOptions=c}var m=i("./stringReader"),l=i("./utils"),k=i("./compressedObject"),j=i("./object");n.prototype={isEncrypted:function(){return 1===(1&this.bitFlag)},useUTF8:function(){return 2048===(2048&this.bitFlag)},prepareCompressedContent:function(e,d,f){return function(){var c=e.index;e.setIndex(d);var a=e.readData(f);return e.setIndex(c),a}},prepareContent:function(g,e,q,p,o){return function(){var d=l.transformTo(p.uncompressInputType,this.getCompressedContent()),c=p.uncompress(d);if(c.length!==o){throw new Error("Bug : uncompressed data size mismatch")}return c}},readLocalPart:function(e){var d,f;if(e.skip(22),this.fileNameLength=e.readInt(2),f=e.readInt(2),this.fileName=e.readString(this.fileNameLength),e.skip(f),-1==this.compressedSize||-1==this.uncompressedSize){throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)")}if(d=l.findCompression(this.compressionMethod),null===d){throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")")}if(this.decompressed=new k,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(e,e.index,this.compressedSize,d),this.decompressed.getContent=this.prepareContent(e,e.index,this.compressedSize,d,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=l.transformTo("string",this.decompressed.getContent()),j.crc32(this.decompressed)!==this.crc32)){throw new Error("Corrupted zip : CRC32 mismatch")}},readCentralPart:function(c){if(this.versionMadeBy=c.readString(2),this.versionNeeded=c.readInt(2),this.bitFlag=c.readInt(2),this.compressionMethod=c.readString(2),this.date=c.readDate(),this.crc32=c.readInt(4),this.compressedSize=c.readInt(4),this.uncompressedSize=c.readInt(4),this.fileNameLength=c.readInt(2),this.extraFieldsLength=c.readInt(2),this.fileCommentLength=c.readInt(2),this.diskNumberStart=c.readInt(2),this.internalFileAttributes=c.readInt(2),this.externalFileAttributes=c.readInt(4),this.localHeaderOffset=c.readInt(4),this.isEncrypted()){throw new Error("Encrypted zip are not supported")}this.fileName=c.readString(this.fileNameLength),this.readExtraFields(c),this.parseZIP64ExtraField(c),this.fileComment=c.readString(this.fileCommentLength),this.dir=16&this.externalFileAttributes?!0:!1},parseZIP64ExtraField:function(){if(this.extraFields[1]){var c=new m(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=c.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=c.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=c.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=c.readInt(4))}},readExtraFields:function(g){var f,q,p,o=g.index;for(this.extraFields=this.extraFields||{};g.index<o+this.extraFieldsLength;){f=g.readInt(2),q=g.readInt(2),p=g.readString(q),this.extraFields[f]={id:f,length:q,value:p}}},handleUTF8:function(){if(this.useUTF8()){this.fileName=j.utf8decode(this.fileName),this.fileComment=j.utf8decode(this.fileComment)}else{var c=this.findExtraFieldUnicodePath();null!==c&&(this.fileName=c)}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var c=new m(d.value);return 1!==c.readInt(1)?null:j.crc32(this.fileName)!==c.readInt(4)?null:j.utf8decode(c.readString(d.length-5))}return null}},h.exports=n},{"./compressedObject":2,"./object":9,"./stringReader":11,"./utils":14}],17:[function(){},{}],18:[function(e,d){var f=d.exports={};f.nextTick=function(){var h="undefined"!=typeof window&&window.setImmediate,g="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(h){return function(c){return window.setImmediate(c)}}if(g){var i=[];return window.addEventListener("message",function(j){var c=j.source;if((c===window||null===c)&&"process-tick"===j.data&&(j.stopPropagation(),i.length>0)){var k=i.shift();k()}},!0),function(c){i.push(c),window.postMessage("process-tick","*")}}return function(c){setTimeout(c,0)}}(),f.title="browser",f.browser=!0,f.env={},f.argv=[],f.binding=function(){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(){throw new Error("process.chdir is not supported")}},{}],19:[function(){(function(){function aj(g,f){var j=g.split("."),i=W;!(j[0] in i)&&i.execScript&&i.execScript("var "+j[0]);for(var h;j.length&&(h=j.shift());){j.length||f===Y?i=i[h]?i[h]:i[h]={}:i[h]=f}}function ai(d,c){if(this.index="number"==typeof c?c:0,this.d=0,this.buffer=d instanceof (V?Uint8Array:Array)?d:new (V?Uint8Array:Array)(32768),2*this.buffer.length<=this.index){throw Error("invalid index")}this.buffer.length<=this.index&&ah(this)}function ah(g){var f,j=g.buffer,i=j.length,h=new (V?Uint8Array:Array)(i<<1);if(V){h.set(j)}else{for(f=0;i>f;++f){h[f]=j[f]}}return g.buffer=h}function ag(c){this.buffer=new (V?Uint16Array:Array)(2*c),this.length=0}function af(d,c){this.e=I,this.f=0,this.input=V&&d instanceof Array?new Uint8Array(d):d,this.c=0,c&&(c.lazy&&(this.f=c.lazy),"number"==typeof c.compressionType&&(this.e=c.compressionType),c.outputBuffer&&(this.b=V&&c.outputBuffer instanceof Array?new Uint8Array(c.outputBuffer):c.outputBuffer),"number"==typeof c.outputIndex&&(this.c=c.outputIndex)),this.b||(this.b=new (V?Uint8Array:Array)(32768))}function ae(d,c){this.length=d,this.g=c}function ad(at,ar){function aq(u,t){var s,r=u.g,q=[],p=0;s=F[u.length],q[p++]=65535&s,q[p++]=s>>16&255,q[p++]=s>>24;var n;switch(X){case 1===r:n=[0,r-1,0];break;case 2===r:n=[1,r-2,0];break;case 3===r:n=[2,r-3,0];break;case 4===r:n=[3,r-4,0];break;case 6>=r:n=[4,r-5,1];break;case 8>=r:n=[5,r-7,1];break;case 12>=r:n=[6,r-9,2];break;case 16>=r:n=[7,r-13,2];break;case 24>=r:n=[8,r-17,3];break;case 32>=r:n=[9,r-25,3];break;case 48>=r:n=[10,r-33,4];break;case 64>=r:n=[11,r-49,4];break;case 96>=r:n=[12,r-65,5];break;case 128>=r:n=[13,r-97,5];break;case 192>=r:n=[14,r-129,6];break;case 256>=r:n=[15,r-193,6];break;case 384>=r:n=[16,r-257,7];break;case 512>=r:n=[17,r-385,7];break;case 768>=r:n=[18,r-513,8];break;case 1024>=r:n=[19,r-769,8];break;case 1536>=r:n=[20,r-1025,9];break;case 2048>=r:n=[21,r-1537,9];break;case 3072>=r:n=[22,r-2049,10];break;case 4096>=r:n=[23,r-3073,10];break;case 6144>=r:n=[24,r-4097,11];break;case 8192>=r:n=[25,r-6145,11];break;case 12288>=r:n=[26,r-8193,12];break;case 16384>=r:n=[27,r-12289,12];break;case 24576>=r:n=[28,r-16385,13];break;case 32768>=r:n=[29,r-24577,13];break;default:throw"invalid distance"}s=n,q[p++]=s[0],q[p++]=s[1],q[p++]=s[2];var k,j;for(k=0,j=q.length;j>k;++k){A[z++]=q[k]}m[q[0]]++,l[q[3]]++,o=u.length+t-1,D=null}var ap,ao,an,am,al,ak,E,D,C,B={},A=V?new Uint16Array(2*ar.length):[],z=0,o=0,m=new (V?Uint32Array:Array)(286),l=new (V?Uint32Array:Array)(30),h=at.f;if(!V){for(an=0;285>=an;){m[an++]=0}for(an=0;29>=an;){l[an++]=0}}for(m[256]=1,ap=0,ao=ar.length;ao>ap;++ap){for(an=al=0,am=3;am>an&&ap+an!==ao;++an){al=al<<8|ar[ap+an]}if(B[al]===Y&&(B[al]=[]),ak=B[al],!(0<o--)){for(;0<ak.length&&32768<ap-ak[0];){ak.shift()}if(ap+3>=ao){for(D&&aq(D,-1),an=0,am=ao-ap;am>an;++an){C=ar[ap+an],A[z++]=C,++m[C]}break}0<ak.length?(E=ac(ar,ap,ak),D?D.length<E.length?(C=ar[ap-1],A[z++]=C,++m[C],aq(E,0)):aq(D,-1):E.length<h?D=E:aq(E,0)):D?aq(D,-1):(C=ar[ap],A[z++]=C,++m[C])}ak.push(ap)}return A[z++]=256,m[256]++,at.j=m,at.i=l,V?A.subarray(0,z):A}function ac(v,u,t){var s,r,q,p,o,n,m=0,f=v.length;p=0,n=t.length;v:for(;n>p;p++){if(s=t[n-p-1],q=3,m>3){for(o=m;o>3;o--){if(v[s+o-1]!==v[u+o-1]){continue v}}q=m}for(;258>q&&f>u+q&&v[s+q]===v[u+q];){++q}if(q>m&&(r=s,m=q),258===q){break}}return new ae(m,u-r)}function ab(t,s){var r,q,p,o,n,m=t.length,j=new ag(572),d=new (V?Uint8Array:Array)(m);if(!V){for(o=0;m>o;o++){d[o]=0}}for(o=0;m>o;++o){0<t[o]&&j.push(o,t[o])}if(r=Array(j.length/2),q=new (V?Uint32Array:Array)(j.length/2),1===r.length){return d[j.pop().index]=1,d}for(o=0,n=j.length/2;n>o;++o){r[o]=j.pop(),q[o]=r[o].value}for(p=aa(q,q.length,s),o=0,n=r.length;n>o;++o){d[r[o].index]=p[o]}return d}function aa(ao,an,am){function al(d){var e=u[d][t[d]];e===an?(al(d+1),al(d+1)):--w[e],++t[d]}var ak,E,D,C,B,A=new (V?Uint16Array:Array)(am),z=new (V?Uint8Array:Array)(am),w=new (V?Uint8Array:Array)(an),v=Array(am),u=Array(am),t=Array(am),s=(1<<am)-an,o=1<<am-1;for(A[am-1]=an,E=0;am>E;++E){o>s?z[E]=0:(z[E]=1,s-=o),s<<=1,A[am-2-E]=(A[am-1-E]/2|0)+an}for(A[0]=z[0],v[0]=Array(A[0]),u[0]=Array(A[0]),E=1;am>E;++E){A[E]>2*A[E-1]+z[E]&&(A[E]=2*A[E-1]+z[E]),v[E]=Array(A[E]),u[E]=Array(A[E])}for(ak=0;an>ak;++ak){w[ak]=am}for(D=0;D<A[am-1];++D){v[am-1][D]=ao[D],u[am-1][D]=D}for(ak=0;am>ak;++ak){t[ak]=0}for(1===z[am-1]&&(--w[0],++t[am-1]),E=am-2;E>=0;--E){for(C=ak=0,B=t[E+1],D=0;D<A[E];D++){C=v[E+1][B]+v[E+1][B+1],C>ao[ak]?(v[E][D]=C,u[E][D]=an,B+=2):(v[E][D]=ao[ak],u[E][D]=ak,++ak)}t[E]=0,1===z[E]&&al(E)}return w}function Z(r){var q,p,o,n,m=new (V?Uint16Array:Array)(r.length),l=[],k=[],j=0;for(q=0,p=r.length;p>q;q++){l[r[q]]=(0|l[r[q]])+1}for(q=1,p=16;p>=q;q++){k[q]=j,j+=0|l[q],j<<=1}for(q=0,p=r.length;p>q;q++){for(j=k[r[q]],k[r[q]]+=1,o=m[q]=0,n=r[q];n>o;o++){m[q]=m[q]<<1|1&j,j>>>=1}}return m}var Y=void 0,X=!0,W=this,V="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array;ai.prototype.a=function(j,c,p){var o,n=this.buffer,m=this.index,l=this.d,k=n[m];if(p&&c>1&&(j=c>8?(K[255&j]<<24|K[j>>>8&255]<<16|K[j>>>16&255]<<8|K[j>>>24&255])>>32-c:K[j]>>8-c),8>c+l){k=k<<c|j,l+=c}else{for(o=0;c>o;++o){k=k<<1|j>>c-o-1&1,8===++l&&(l=0,n[m++]=K[k],k=0,m===n.length&&(n=ah(this)))}}n[m]=k,this.buffer=n,this.d=l,this.index=m},ai.prototype.finish=function(){var e,d=this.buffer,f=this.index;return 0<this.d&&(d[f]<<=8-this.d,d[f]=K[d[f]],f++),V?e=d.subarray(0,f):(d.length=f,e=d),e};var U,S=new (V?Uint8Array:Array)(256);for(U=0;256>U;++U){for(var Q=U,O=Q,M=7,Q=Q>>>1;Q;Q>>>=1){O<<=1,O|=1&Q,--M}S[U]=(O<<M&255)>>>0}var K=S;ag.prototype.getParent=function(c){return 2*((c-2)/4|0)},ag.prototype.push=function(h,g){var l,k,j,i=this.buffer;for(l=this.length,i[this.length++]=g,i[this.length++]=h;l>0&&(k=this.getParent(l),i[l]>i[k]);){j=i[l],i[l]=i[k],i[k]=j,j=i[l+1],i[l+1]=i[k+1],i[k+1]=j,l=k}return this.length},ag.prototype.pop=function(){var h,g,l,k,j,i=this.buffer;for(g=i[0],h=i[1],this.length-=2,i[0]=i[this.length],i[1]=i[this.length+1],j=0;(k=2*j+2,!(k>=this.length))&&(k+2<this.length&&i[k+2]>i[k]&&(k+=2),i[k]>i[j]);){l=i[j],i[j]=i[k],i[k]=l,l=i[j+1],i[j+1]=i[k+1],i[k+1]=l,j=k}return{index:h,value:g,length:this.length}};var J,I=2,H=[];for(J=0;288>J;J++){switch(X){case 143>=J:H.push([J+48,8]);break;case 255>=J:H.push([J-144+400,9]);break;case 279>=J:H.push([J-256+0,7]);break;case 287>=J:H.push([J-280+192,8]);break;default:throw"invalid literal: "+J}}af.prototype.h=function(){var a7,a6,a5,a4,a3=this.input;switch(this.e){case 0:for(a5=0,a4=a3.length;a4>a5;){a6=V?a3.subarray(a5,a5+65535):a3.slice(a5,a5+65535),a5+=a6.length;var a2=a6,a1=a5===a4,a0=Y,aZ=Y,aY=Y,aX=Y,aW=Y,aV=this.b,aU=this.c;if(V){for(aV=new Uint8Array(this.b.buffer);aV.length<=aU+a2.length+5;){aV=new Uint8Array(aV.length<<1)}aV.set(this.b)}if(a0=a1?1:0,aV[aU++]=0|a0,aZ=a2.length,aY=~aZ+65536&65535,aV[aU++]=255&aZ,aV[aU++]=aZ>>>8&255,aV[aU++]=255&aY,aV[aU++]=aY>>>8&255,V){aV.set(a2,aU),aU+=a2.length,aV=aV.subarray(0,aU)}else{for(aX=0,aW=a2.length;aW>aX;++aX){aV[aU++]=a2[aX]}aV.length=aU}this.c=aU,this.b=aV}break;case 1:var aT=new ai(V?new Uint8Array(this.b.buffer):this.b,this.c);aT.a(1,1,X),aT.a(1,2,X);var aS,aQ,aH,aF=ad(this,a3);for(aS=0,aQ=aF.length;aQ>aS;aS++){if(aH=aF[aS],ai.prototype.a.apply(aT,H[aH]),aH>256){aT.a(aF[++aS],aF[++aS],X),aT.a(aF[++aS],5),aT.a(aF[++aS],aF[++aS],X)}else{if(256===aH){break}}}this.b=aT.finish(),this.c=this.b.length;break;case I:var aE,aD,aC,aB,aA,az,ay,ax,aw,av,au,at,ar,aq,ap,ao=new ai(V?new Uint8Array(this.b.buffer):this.b,this.c),an=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],am=Array(19);for(aE=I,ao.a(1,1,X),ao.a(aE,2,X),aD=ad(this,a3),az=ab(this.j,15),ay=Z(az),ax=ab(this.i,7),aw=Z(ax),aC=286;aC>257&&0===az[aC-1];aC--){}for(aB=30;aB>1&&0===ax[aB-1];aB--){}var al,ak,w,o,m,l,aM=aC,a9=aB,aG=new (V?Uint32Array:Array)(aM+a9),a8=new (V?Uint32Array:Array)(316),aN=new (V?Uint8Array:Array)(19);for(al=ak=0;aM>al;al++){aG[ak++]=az[al]}for(al=0;a9>al;al++){aG[ak++]=ax[al]}if(!V){for(al=0,o=aN.length;o>al;++al){aN[al]=0}}for(al=m=0,o=aG.length;o>al;al+=ak){for(ak=1;o>al+ak&&aG[al+ak]===aG[al];++ak){}if(w=ak,0===aG[al]){if(3>w){for(;0<w--;){a8[m++]=0,aN[0]++}}else{for(;w>0;){l=138>w?w:138,l>w-3&&w>l&&(l=w-3),10>=l?(a8[m++]=17,a8[m++]=l-3,aN[17]++):(a8[m++]=18,a8[m++]=l-11,aN[18]++),w-=l}}}else{if(a8[m++]=aG[al],aN[aG[al]]++,w--,3>w){for(;0<w--;){a8[m++]=aG[al],aN[aG[al]]++}}else{for(;w>0;){l=6>w?w:6,l>w-3&&w>l&&(l=w-3),a8[m++]=16,a8[m++]=l-3,aN[16]++,w-=l}}}}for(a7=V?a8.subarray(0,m):a8.slice(0,m),av=ab(aN,7),aq=0;19>aq;aq++){am[aq]=av[an[aq]]}for(aA=19;aA>4&&0===am[aA-1];aA--){}for(au=Z(av),ao.a(aC-257,5,X),ao.a(aB-1,5,X),ao.a(aA-4,4,X),aq=0;aA>aq;aq++){ao.a(am[aq],3,X)}for(aq=0,ap=a7.length;ap>aq;aq++){if(at=a7[aq],ao.a(au[at],av[at],X),at>=16){switch(aq++,at){case 16:ar=2;break;case 17:ar=3;break;case 18:ar=7;break;default:throw"invalid code: "+at}ao.a(a7[aq],ar,X)}}var aI,g,aO,aJ,i,aP,aK,k,aR=[ay,az],aL=[aw,ax];for(i=aR[0],aP=aR[1],aK=aL[0],k=aL[1],aI=0,g=aD.length;g>aI;++aI){if(aO=aD[aI],ao.a(i[aO],aP[aO],X),aO>256){ao.a(aD[++aI],aD[++aI],X),aJ=aD[++aI],ao.a(aK[aJ],k[aJ],X),ao.a(aD[++aI],aD[++aI],X)}else{if(256===aO){break}}}this.b=ao.finish(),this.c=this.b.length;break;default:throw"invalid compression type"}return this.b};var G=function(){function f(c){switch(X){case 3===c:return[257,c-3,0];case 4===c:return[258,c-4,0];case 5===c:return[259,c-5,0];case 6===c:return[260,c-6,0];case 7===c:return[261,c-7,0];case 8===c:return[262,c-8,0];case 9===c:return[263,c-9,0];case 10===c:return[264,c-10,0];case 12>=c:return[265,c-11,1];case 14>=c:return[266,c-13,1];case 16>=c:return[267,c-15,1];case 18>=c:return[268,c-17,1];case 22>=c:return[269,c-19,2];case 26>=c:return[270,c-23,2];case 30>=c:return[271,c-27,2];case 34>=c:return[272,c-31,2];case 42>=c:return[273,c-35,3];case 50>=c:return[274,c-43,3];case 58>=c:return[275,c-51,3];case 66>=c:return[276,c-59,3];case 82>=c:return[277,c-67,4];case 98>=c:return[278,c-83,4];case 114>=c:return[279,c-99,4];case 130>=c:return[280,c-115,4];case 162>=c:return[281,c-131,5];case 194>=c:return[282,c-163,5];case 226>=c:return[283,c-195,5];case 257>=c:return[284,c-227,5];case 258===c:return[285,c-258,0];default:throw"invalid length: "+c}}var e,h,g=[];for(e=3;258>=e;e++){h=f(e),g[e]=h[2]<<24|h[1]<<16|h[0]}return g}(),F=V?new Uint32Array(G):G;aj("Zlib.RawDeflate",af),aj("Zlib.RawDeflate.prototype.compress",af.prototype.h);var T,R,P,N,L={NONE:0,FIXED:1,DYNAMIC:I};if(Object.keys){T=Object.keys(L)}else{for(R in T=[],P=0,L){T[P++]=R}}for(P=0,N=T.length;N>P;++P){R=T[P],aj("Zlib.RawDeflate.CompressionType."+R,L[R])}}).call(this)},{}],20:[function(){(function(){function ap(g,f){var j=g.split("."),i=ai;!(j[0] in i)&&i.execScript&&i.execScript("var "+j[0]);for(var h;j.length&&(h=j.shift());){j.length||f===aj?i=i[h]?i[h]:i[h]={}:i[h]=f}}function ao(B){var A,z,w,v,u,t,s,r,q,p=B.length,o=0,i=Number.POSITIVE_INFINITY;for(r=0;p>r;++r){B[r]>o&&(o=B[r]),B[r]<i&&(i=B[r])}for(A=1<<o,z=new (ah?Uint32Array:Array)(A),w=1,v=0,u=2;o>=w;){for(r=0;p>r;++r){if(B[r]===w){for(t=0,s=v,q=0;w>q;++q){t=t<<1|1&s,s>>=1}for(q=t;A>q;q+=u){z[q]=w<<16|r}++v}}++w,v<<=1,u<<=1}return[z,o,i]}function an(d,c){switch(this.g=[],this.h=32768,this.c=this.f=this.d=this.k=0,this.input=ah?new Uint8Array(d):d,this.l=!1,this.i=af,this.p=!1,(c||!(c={}))&&(c.index&&(this.d=c.index),c.bufferSize&&(this.h=c.bufferSize),c.bufferType&&(this.i=c.bufferType),c.resize&&(this.p=c.resize)),this.i){case ag:this.a=32768,this.b=new (ah?Uint8Array:Array)(32768+this.h+258);break;case af:this.a=0,this.b=new (ah?Uint8Array:Array)(this.h),this.e=this.u,this.m=this.r,this.j=this.s;break;default:throw Error("invalid inflate mode")}}function am(i,g){for(var n,m=i.f,l=i.c,k=i.input,j=i.d;g>l;){if(n=k[j++],n===aj){throw Error("input buffer is broken")}m|=n<<l,l+=8}return n=m&(1<<g)-1,i.f=m>>>g,i.c=l-g,i.d=j,n}function al(v,u){for(var t,s,r,q=v.f,p=v.c,o=v.input,n=v.d,m=u[0],g=u[1];g>p&&(t=o[n++],t!==aj);){q|=t<<p,p+=8}return s=m[q&(1<<g)-1],r=s>>>16,v.f=q>>r,v.c=p-r,v.d=n,65535&s}function ak(u){function t(k,j,w){var v,n,m,l;for(l=0;k>l;){switch(v=al(this,j)){case 16:for(m=3+am(this,2);m--;){w[l++]=n}break;case 17:for(m=3+am(this,3);m--;){w[l++]=0}n=0;break;case 18:for(m=11+am(this,7);m--;){w[l++]=0}n=0;break;default:n=w[l++]=v}}return w}var s,r,q,p,o=am(u,5)+257,i=am(u,5)+1,e=am(u,4)+4,d=new (ah?Uint8Array:Array)(ab.length);for(p=0;e>p;++p){d[ab[p]]=am(u,3)}s=ao(d),r=new (ah?Uint8Array:Array)(o),q=new (ah?Uint8Array:Array)(i),u.j(ao(t.call(u,o,s,r)),ao(t.call(u,i,s,q)))}var aj=void 0,ai=this,ah="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,ag=0,af=1;an.prototype.t=function(){for(;!this.l;){var t=am(this,3);switch(1&t&&(this.l=!0),t>>>=1){case 0:var s=this.input,r=this.d,q=this.b,k=this.a,j=aj,i=aj,g=aj,f=q.length,d=aj;if(this.c=this.f=0,j=s[r++],j===aj){throw Error("invalid uncompressed block header: LEN (first byte)")}if(i=j,j=s[r++],j===aj){throw Error("invalid uncompressed block header: LEN (second byte)")}if(i|=j<<8,j=s[r++],j===aj){throw Error("invalid uncompressed block header: NLEN (first byte)")}if(g=j,j=s[r++],j===aj){throw Error("invalid uncompressed block header: NLEN (second byte)")}if(g|=j<<8,i===~g){throw Error("invalid uncompressed block header: length verify")}if(r+i>s.length){throw Error("input buffer is broken")}switch(this.i){case ag:for(;k+i>q.length;){if(d=f-k,i-=d,ah){q.set(s.subarray(r,r+d),k),k+=d,r+=d}else{for(;d--;){q[k++]=s[r++]}}this.a=k,q=this.e(),k=this.a}break;case af:for(;k+i>q.length;){q=this.e({o:2})}break;default:throw Error("invalid inflate mode")}if(ah){q.set(s.subarray(r,r+i),k),k+=i,r+=i}else{for(;i--;){q[k++]=s[r++]}}this.d=r,this.a=k,this.b=q;break;case 1:this.j(Z,V);break;case 2:ak(this);break;default:throw Error("unknown BTYPE: "+t)}}return this.m()};var ae,ad,ac=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ab=ah?new Uint16Array(ac):ac,aa=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],Y=ah?new Uint16Array(aa):aa,W=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],U=ah?new Uint8Array(W):W,S=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Q=ah?new Uint16Array(S):S,O=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],M=ah?new Uint8Array(O):O,K=new (ah?Uint8Array:Array)(288);for(ae=0,ad=K.length;ad>ae;++ae){K[ae]=143>=ae?8:255>=ae?9:279>=ae?7:8}var J,I,Z=ao(K),X=new (ah?Uint8Array:Array)(30);for(J=0,I=X.length;I>J;++J){X[J]=5}var V=ao(X);an.prototype.j=function(r,q){var p=this.b,o=this.a;this.n=r;for(var n,m,l,e,d=p.length-258;256!==(n=al(this,r));){if(256>n){o>=d&&(this.a=o,p=this.e(),o=this.a),p[o++]=n}else{for(m=n-257,e=Y[m],0<U[m]&&(e+=am(this,U[m])),n=al(this,q),l=Q[n],0<M[n]&&(l+=am(this,M[n])),o>=d&&(this.a=o,p=this.e(),o=this.a);e--;){p[o]=p[o++-l]}}}for(;8<=this.c;){this.c-=8,this.d--}this.a=o},an.prototype.s=function(r,q){var p=this.b,o=this.a;this.n=r;for(var n,m,l,e,d=p.length;256!==(n=al(this,r));){if(256>n){o>=d&&(p=this.e(),d=p.length),p[o++]=n}else{for(m=n-257,e=Y[m],0<U[m]&&(e+=am(this,U[m])),n=al(this,q),l=Q[n],0<M[n]&&(l+=am(this,M[n])),o+e>d&&(p=this.e(),d=p.length);e--;){p[o]=p[o++-l]}}}for(;8<=this.c;){this.c-=8,this.d--}this.a=o},an.prototype.e=function(){var g,f,j=new (ah?Uint8Array:Array)(this.a-32768),i=this.a-32768,h=this.b;if(ah){j.set(h.subarray(32768,j.length))}else{for(g=0,f=j.length;f>g;++g){j[g]=h[g+32768]}}if(this.g.push(j),this.k+=j.length,ah){h.set(h.subarray(i,i+32768))}else{for(g=0;32768>g;++g){h[g]=h[i+g]}}return this.a=32768,h},an.prototype.u=function(j){var i,p,o,n,m=this.input.length/this.d+1|0,l=this.input,k=this.b;return j&&("number"==typeof j.o&&(m=j.o),"number"==typeof j.q&&(m+=j.q)),2>m?(p=(l.length-this.d)/this.n[2],n=258*(p/2)|0,o=n<k.length?k.length+n:k.length<<1):o=k.length*m,ah?(i=new Uint8Array(o),i.set(k)):i=k,this.b=i},an.prototype.m=function(){var r,q,p,o,n,m=0,l=this.b,k=this.g,i=new (ah?Uint8Array:Array)(this.k+(this.a-32768));if(0===k.length){return ah?this.b.subarray(32768,this.a):this.b.slice(32768,this.a)}for(q=0,p=k.length;p>q;++q){for(r=k[q],o=0,n=r.length;n>o;++o){i[m++]=r[o]}}for(q=32768,p=this.a;p>q;++q){i[m++]=l[q]}return this.g=[],this.buffer=i},an.prototype.r=function(){var d,c=this.a;return ah?this.p?(d=new Uint8Array(c),d.set(this.b.subarray(0,c))):d=this.b.subarray(0,c):(this.b.length>c&&(this.b.length=c),d=this.b),this.buffer=d},ap("Zlib.RawInflate",an),ap("Zlib.RawInflate.prototype.decompress",an.prototype.t);var T,R,P,N,L={ADAPTIVE:af,BLOCK:ag};if(Object.keys){T=Object.keys(L)}else{for(R in T=[],P=0,L){T[P++]=R}}for(P=0,N=T.length;N>P;++P){R=T[P],ap("Zlib.RawInflate.BufferType."+R,L[R])}}).call(this)},{}]},{},[7])(7)});(function(){var b=0;var c=["ms","moz","webkit","o"];for(var a=0;a<c.length&&!window.requestAnimationFrame;++a){window.requestAnimationFrame=window[c[a]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[c[a]+"CancelAnimationFrame"]||window[c[a]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(h,e){var d=new Date().getTime();var f=Math.max(0,16-(d-b));var g=window.setTimeout(function(){h(d+f)},f);b=d+f;return g}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(d){clearTimeout(d)}}}());var utils={reloadWithMessage:function(b){function a(){storage._setItem("postloadMessage",b);location.reload()}if(fluid.main.deferReload){fluid.main.on("deferReloadRelease",a)}else{a()}},selectText:function(b){var a=(b=="control+a")?$(".ui-selected").find("textarea"):$(this);a.focus();a.select();return false},getTLWH:function(c){var e=$(c);if(e.length==0){return{top:0,left:0,width:0,height:0}}var b=e.offset();var d=e.outerWidth();var a=e.outerHeight();return{top:b.top,left:b.left,width:d,height:a}},getCenterPoint:function(a){var c=utils.getTLWH(a);var d=Math.floor(c.top+(c.height/2));var b=Math.floor(c.left+(c.width/2));return{top:d,left:b}},getTranslateDistanceToCenter:function(t,q){var k=$(t).outerWidth();var r=$(t).outerHeight();var f=parseFloat($(t).css("top"));var j=parseFloat($(t).css("left"));var h=utils.getCenterPoint(q);var s=utils.getTLWH(q);var m=k-s.width;var l=r-s.height;var a=Math.max(0,m,l);var d=a==m?false:true;var b=a==l?false:true;var e=-parseFloat($("#viewport").get(0).scrollTop);var g=-parseFloat($("#viewport").get(0).scrollLeft);var i=b?f+r/2:f;var c=d?j+k/2:j;var p=h.top-i-e;var o=h.left-c-g;if(l>0){var n=0.5*s.height-95;p=p-n}return{top:p,left:o}},getBoundingAreaRelative:function(b){var c=$(b);if(c.length==0){return{top:0,left:0,bottom:0,right:0}}var a={top:null,left:null,right:null,bottom:null};$(c).each(function(){var f=$(this);var d={top:parseFloat(f.css("top")),left:parseFloat(f.css("left")),width:parseFloat(f.css("width")),height:parseFloat(f.css("height"))};if(f.hasClass("screen")){var e=$(".page",f);d={top:parseFloat(f.css("top")),left:parseFloat(f.css("left")),width:parseFloat(e.css("width")),height:parseFloat(e.css("height"))}}if((a.left>d.left)||a.left==null){a.left=~~d.left}if((a.top>d.top)||a.top==null){a.top=~~d.top}if((a.right<d.left+d.width)||a.right==null){a.right=~~(d.left+d.width)}if((a.bottom<d.top+d.height)||a.bottom==null){a.bottom=~~(d.top+d.height)}});return a},getBoundingArea:function(a){utils.boundingLeft=null;utils.boundingTop=null;utils.boundingRight=null;utils.boundingBottom=null;var c=$(a);if(c.length==0){return{top:0,left:0,bottom:0,right:0}}c.each(function(){var d=utils.getTLWH(this);if((utils.boundingLeft>d.left)||utils.boundingLeft==null){utils.boundingLeft=d.left}if((utils.boundingTop>d.top)||utils.boundingTop==null){utils.boundingTop=d.top}if((utils.boundingRight<d.left+d.width)||utils.boundingRight==null){utils.boundingRight=d.left+d.width}if((utils.boundingBottom<d.top+d.height)||utils.boundingBottom==null){utils.boundingBottom=d.top+d.height}});var b={top:utils.boundingTop,left:utils.boundingLeft,bottom:utils.boundingBottom,right:utils.boundingRight};return b},guid:function(b){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";var f=32;var d="";for(var c=0;c<f;c++){var a=Math.floor(Math.random()*e.length);d+=e.substring(a,a+1)}return b+"_"+d},prevent:function(a){a.stopPropagation();a.preventDefault();return false},arraysEqual:function(d,c){var e=d.length==c.length;if(e){for(var b=0,a=d.length;b<a;b++){e=d[b]===c[b];if(!e){break}}}return e},hslToHex:function(j){function i(g,b,l){if(l<0){l+=1}else{if(l>1){l-=1}}if(l*6<1){return g+(b-g)*l*6}if(l*2<1){return b}if(l*3<2){return g+(b-g)*(2/3-l)*6}return g}var d=j.h/360,n=j.s/100,c=j.l/100;var m,k;if(c<=0.5){k=c*(1+n)}else{k=c+n-(c*n)}m=c*2-k;var a=i(m,k,d+1/3);var e=i(m,k,d);var f=i(m,k,d-1/3);a=Math.round(a*255);e=Math.round(e*255);f=Math.round(f*255);a=parseInt(a).toString(16);e=parseInt(e).toString(16);f=parseInt(f).toString(16);if(a.length<2){a="0"+a}if(e.length<2){e="0"+e}if(f.length<2){f="0"+f}return a+e+f},hex2rgba:function(d,b){if(!d[0]=="#"){return false}if(d.indexOf("rgba(")===0){return d}if(d.indexOf("rgb(")===0){var c;d=d.replace("rgb(","rgba(");c=d.split(",");c[c.length-1]=parseInt(c[c.length-1]);c.push("1)");d=c.join(",");return d}if(d.length=="4"){d="#"+d[1]+d[1]+d[2]+d[2]+d[3]+d[3]}return"rgba("+(parseInt(d.substr(1,2),16))+","+(parseInt(d.substr(3,2),16))+","+(parseInt(d.substr(5,2),16))+","+(b||1)+")"},rgb2hex:function(a){a=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);function b(c){return("0"+parseInt(c).toString(16)).slice(-2)}return"#"+b(a[1])+b(a[2])+b(a[3])},toHSL:function(m){var m=(m)?m:"rgb(0, 0, 0)";m=m.replace(/ /g,"");if(m.match(/hsla/gi)){return{h:m.match(/[0-9]*/g)[5],s:m.match(/[0-9]*/g)[7],l:m.match(/[0-9]*/g)[10]}}if(m.match(/hsl/gi)){return{h:m.match(/[0-9]*/g)[4],s:m.match(/[0-9]*/g)[6],l:m.match(/[0-9]*/g)[9]}}if(m.match(/#/gi)){if(m.length==4){m="#"+m[1]+m[1]+m[2]+m[2]+m[3]+m[3]}else{if(m.length!=7){m="#000000"}}var a=parseInt(m.substring(1,3),16);var i=parseInt(m.substring(3,5),16);var k=parseInt(m.substring(5,7),16)}else{if(m.match(/rgba/gi)){var a=m.match(/[0-9]*/g)[5];var i=m.match(/[0-9]*/g)[7];var k=m.match(/[0-9]*/g)[9]}else{if(m.match(/rgb/gi)){var a=m.match(/[0-9]*/g)[4];var i=m.match(/[0-9]*/g)[6];var k=m.match(/[0-9]*/g)[8]}}}a/=255,i/=255,k/=255;var c=Math.max(a,i,k);var e=Math.min(a,i,k);var f=0;var n=0;var d=(c+e)/2;if(c!=e){var j=c-e;n=(d<0.5)?j/(c+e):j/(2-c-e);switch(c){case a:f=(i-k)/j;break;case i:f=(k-a)/j+2;break;case k:f=(a-i)/j+4;break}f/=6;if(f<0){f+=1}}f=f*360;d=d*100;n=n*100;return{h:f,s:n,l:d}},replaceRgbaAlpha:function(c,b){var d=c.match(/rgba/i);if(d){ret=c.split(",");ret[ret.length-1]=b+")";ret=ret.join(",");return ret}return c},getRgbaAlpha:function(b){if(b[0]=="#"||b.indexOf("rgb(")!=-1){return 1}var a=b.split(",");a=a[a.length-1];a=parseFloat(a);return a},getAlphaFromColor:function(a){if(a[0]=="#"){return 1}else{if(a.indexOf("rgba(")===0){a=a.split(",");a=a[a.length-1].replace(")","");return a}}return 1},isMobileDevice:function(){var a=false;if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i)){a=true}return a},hideBrowserBar:function(){var a=false;if(navigator.userAgent.match(/Android/i)){a=true}return a},isMouseOver:function(b,a){var c=a.offset();return b.pageX>=c.left&&b.pageX<(c.left+a.outerWidth())&&b.pageY>=c.top&&b.pageY<(c.top+a.outerHeight())},relativeMousePos:function(b,a){var c=a.offset();return{top:b.pageY-c.top,left:b.pageX-c.left}},animateRaf:function(a,e,i,d,k){if($.isFunction(i)){d=i;i=undefined}var b,g,f,j=false;var h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(l){window.setTimeout(function(){l(new Date().valueOf())},16.667)};function c(n){if(!j&&n<946684800000){if(f){b=startTimeHiResClock;g=endTimeHiResClock;j=true}else{n=new Date().valueOf()}}var l=n-b;var m=g!=b?l/e:1;if(m<1){if(i){m=i(m,l,0,1,e)}a(m,k);h(c)}else{a(1,k);if(d&&$.isFunction(d)){window.setTimeout(d,10)}}}if(e===undefined){e=300}f=window.hasOwnProperty("performance")&&window.performance.hasOwnProperty("now");b=new Date().valueOf();startTimeHiResClock=f?window.performance.now():b;g=b+e;endTimeHiResClock=startTimeHiResClock+e;if(i){i=$.easing[i]}h(c)},toPercent:function(c,f,d){if(typeof c=="string"){var e=utils.parsePercentString(c);c=e&&!isNaN(e)?e*f/100:parseFloat(c)}var a=c*100/f;var b=Math.pow(10,d);return(Math.round(a*b))/b},parsePercentString:function(c){var b=NaN;if(typeof c=="string"){var a=c.match(/^\s*(\d+(?:\.\d*)?|\.\d+)\s*\%\s*$/);if(a){b=parseFloat(a[1])}}return b},isPercentString:function(b){var a=utils.parsePercentString(b);return Boolean(a)&&!isNaN(a)},fromPercentString:function(c,b){var a=utils.parsePercentString(c);if(a&&!isNaN(a)){a*=b/100}return a},getNavigationKeyDirection:function(b){var a="";switch(b){case 37:a="left";break;case 38:a="top";break;case 39:a="right";break;case 40:a="bottom";break}return a},replaceTooltip:function(a){},Vector:(function(){function a(b,d,c){if(!(this instanceof a)){return new a(b,d,c)}if(b instanceof Object){d=b.y;c=b.z;b=b.x}c=c||0;if(typeof b!=="number"||typeof d!=="number"){b=d=c=0}this.x=b;this.y=d;this.z=c;a.created++}a.created=0;a.prototype={set:function(b,d,c){if(b instanceof Object){d=b.y;b=b.x;c=b.z}c=c||0;if(typeof b==="number"&&typeof d==="number"&&typeof c==="number"){this.x=b;this.y=d;this.z=c}return this},distanceTo:function(c){var b=this.x-c.x,e=this.y-c.y,d=this.z-c.z;return Math.sqrt(b*b+e*e+d*d)},distanceSqTo:function(c){var b=this.x-c.x,e=this.y-c.y,d=this.z-c.z;return b*b+e*e},plus:function(b){return new a(this.x+b.x,this.y+b.y,this.z+b.z)},minus:function(b){return new a(this.x-b.x,this.y-b.y,this.z-b.z)},scale:function(b){return new a(this.x*b,this.y*b,this.z*b)},dot:function(b){return this.x*b.x+this.y*b.y+this.z*b.z},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},angle:function(b){if(!b){b=a.I}else{return this.angle()-b.angle()}if(this.y<0){return 2*Math.PI-(new a(this.x,-this.y,this.y)).angle(b)}return Math.acos(this.dot(b)/(this.magnitude()*b.magnitude()))},rotateBy:function(b){if(b>Math.PI){return this.rotateBy(-(2*Math.PI-b))}else{if(b<-Math.PI){return this.rotateBy(2*Math.PI+b)}}return new a(this.x*Math.cos(b)-this.y*Math.sin(b),this.x*Math.sin(b)+this.y*Math.cos(b))},rotateTo:function(c){var b=c-this.angle();return this.rotateBy(b)},unitVector:function(){return this.scale(1/this.magnitude())},add:function(b){this.x+=b.x;this.y+=b.y;return this},sub:function(b){this.x-=b.x;this.y-=b.y;return this},mul:function(b){this.x*=b;this.y*=b;return this},rotBy:function(b){this.x=this.x*Math.cos(b)-this.y*Math.sin(b);this.y=this.x*Math.sin(b)+this.y*Math.cos(b);return this},rotTo:function(c){var b=c-this.angle();return this.rotBy(b)},copy:function(){return new a(this.x,this.y)},};a.I=Object.freeze(new a(1,0,0));a.J=Object.freeze(new a(0,1,0));a.K=Object.freeze(new a(0,0,1));return a}()),drawVectors:function(l,m,n){var g=[],b=[],h=n[0],f=[],j=m.length;for(var a=j-1,e=0;e<j;e++){b[a]=m[e].distanceTo(m[a]);a=e}for(var e=0,a=j-1;e<j;e++){f[e]=Math.min(h,b[a]/2,b[e]/2)}for(var a=j-1,e=0;e<j;e++){g[a]=m[e].minus(m[a]).unitVector().scale(f[a]);a=e}var k=m[0].plus(g[0]);l.moveTo(k.x,k.y);for(e=0;e<j;e++){var d=e<j-1?e+1:0;k=m[d].minus(g[e]);l.lineTo(k.x,k.y);k=m[d].plus(g[d]);l.quadraticCurveTo(m[d].x,m[d].y,k.x,k.y)}},getFitSize:function(d){var e,f,c=d.object.width>d.frame.width||d.object.height>d.frame.height,a=d.frame.width/d.frame.height,g=d.object.width/d.object.height;if(!c&&!d.expand){return d.object}var b={};if(a>g){e="height";f="width";b.top=0}else{e="width";f="height";b.left=0}b[e]=d.frame[e];b[f]=(d.frame[e]/d.object[e])*d.object[f];return b},isTaintedCanvas:function(b){b=b instanceof HTMLCanvasElement?b.getContext("2d"):b;try{return !b.getImageData(0,0,1,1)}catch(a){return a.code===18}}};jQuery.fn.removeWhitespace=function(){var a=this.contents().filter(function(){return this.nodeType==3&&!/\S/.test(this.nodeValue)}).remove();return this};var fluid=fluid||{};fluid.module=fluid.module||{};(function(a){a.define=function(e,d,h){var i;if(e){var f=e.split(".");i=window;for(var c=0,b=f.length;c<b;c++){var g=f[c];i=i[g]||(i[g]={})}}if(d){d.call(h,i)}return i};a.resolve=function(d){var f;if(d){var e=d.split(".");f=window;for(var c=0,b=e.length;c<b;c++){f=f[e[c]];if(!f){break}}}return f}})(fluid.module);fluid.module.define("fluid.util",function(a){a.debounce=function(c,b){var d;return function(){var f=new Date().getTime();var e;if(!d||f-d>b){e=c.apply(this,arguments);d=f}return e||false}};a.dataUrlToBlob=function(d,c){var f=atob(d.split(",")[1]),e=[];for(var b=0;b<f.length;b++){e.push(f.charCodeAt(b))}return new Blob([new Uint8Array(e)],c)};a.resizeImage=function(f,b,j,h,g,i,e){var d=document.createElement("canvas"),k=d.getContext("2d");d.width=b;d.height=j;if(typeof f==="string"){var c=document.createElement("img");c.src=f;f=c}if(f instanceof Element){if(typeof h==="number"&&typeof g==="number"){k.drawImage(f,h,g,i,e,0,0,b,j)}else{k.drawImage(f,0,0,b,j)}return d.toDataURL()}};a.getGravatarHash=function(b){return a.md5(b.toLowerCase().trim())};a.md5=function(at){function ae(e,f){return(e<<f)|(e>>>(32-f))}function af(i,f){var g,l,j,h,e;j=(i&2147483648);h=(f&2147483648);g=(i&1073741824);l=(f&1073741824);e=(i&1073741823)+(f&1073741823);if(g&l){return(e^2147483648^j^h)}if(g|l){if(e&1073741824){return(e^3221225472^j^h)}else{return(e^1073741824^j^h)}}else{return(e^j^h)}}function au(g,f,e){return(g&f)|((~g)&e)}function av(g,f,e){return(g&e)|(f&(~e))}function aw(g,f,e){return(g^f^e)}function ay(g,f,e){return(f^(g|(~e)))}function aq(h,i,l,j,e,g,f){h=af(h,af(af(au(i,l,j),e),f));return af(ae(h,g),i)}function aF(h,i,l,j,e,g,f){h=af(h,af(af(av(i,l,j),e),f));return af(ae(h,g),i)}function ai(h,i,l,j,e,g,f){h=af(h,af(af(aw(i,l,j),e),f));return af(ae(h,g),i)}function ar(h,i,l,j,e,g,f){h=af(h,af(af(ay(i,l,j),e),f));return af(ae(h,g),i)}function aG(m){var f;var n=m.length;var i=n+8;var g=(i-(i%64))/64;var j=(g+1)*16;var e=Array(j-1);var h=0;var l=0;while(l<n){f=(l-(l%4))/4;h=(l%4)*8;e[f]=(e[f]|(m.charCodeAt(l)<<h));l++}f=(l-(l%4))/4;h=(l%4)*8;e[f]=e[f]|(128<<h);e[j-2]=n<<3;e[j-1]=n>>>29;return e}function ak(e){var f="",h="",g,i;for(i=0;i<=3;i++){g=(e>>>(i*8))&255;h="0"+g.toString(16);f=f+h.substr(h.length-2,2)}return f}function ag(f){f=f.replace(/rn/g,"n");var h="";for(var g=0;g<f.length;g++){var e=f.charCodeAt(g);if(e<128){h+=String.fromCharCode(e)}else{if((e>127)&&(e<2048)){h+=String.fromCharCode((e>>6)|192);h+=String.fromCharCode((e&63)|128)}else{h+=String.fromCharCode((e>>12)|224);h+=String.fromCharCode(((e>>6)&63)|128);h+=String.fromCharCode((e&63)|128)}}}return h}var aj=Array();var aa,aD,ah,ap,aE,b,c,d,k;var H=7,Z=12,ac=17,ad=22;var al=5,am=9,an=14,ao=20;var ax=4,az=11,aA=16,aB=23;var F=6,G=10,I=15,ab=21;at=ag(at);aj=aG(at);b=1732584193;c=4023233417;d=2562383102;k=271733878;for(aa=0;aa<aj.length;aa+=16){aD=b;ah=c;ap=d;aE=k;b=aq(b,c,d,k,aj[aa+0],H,3614090360);k=aq(k,b,c,d,aj[aa+1],Z,3905402710);d=aq(d,k,b,c,aj[aa+2],ac,606105819);c=aq(c,d,k,b,aj[aa+3],ad,3250441966);b=aq(b,c,d,k,aj[aa+4],H,4118548399);k=aq(k,b,c,d,aj[aa+5],Z,1200080426);d=aq(d,k,b,c,aj[aa+6],ac,2821735955);c=aq(c,d,k,b,aj[aa+7],ad,4249261313);b=aq(b,c,d,k,aj[aa+8],H,1770035416);k=aq(k,b,c,d,aj[aa+9],Z,2336552879);d=aq(d,k,b,c,aj[aa+10],ac,4294925233);c=aq(c,d,k,b,aj[aa+11],ad,2304563134);b=aq(b,c,d,k,aj[aa+12],H,1804603682);k=aq(k,b,c,d,aj[aa+13],Z,4254626195);d=aq(d,k,b,c,aj[aa+14],ac,2792965006);c=aq(c,d,k,b,aj[aa+15],ad,1236535329);b=aF(b,c,d,k,aj[aa+1],al,4129170786);k=aF(k,b,c,d,aj[aa+6],am,3225465664);d=aF(d,k,b,c,aj[aa+11],an,643717713);c=aF(c,d,k,b,aj[aa+0],ao,3921069994);b=aF(b,c,d,k,aj[aa+5],al,3593408605);k=aF(k,b,c,d,aj[aa+10],am,38016083);d=aF(d,k,b,c,aj[aa+15],an,3634488961);c=aF(c,d,k,b,aj[aa+4],ao,3889429448);b=aF(b,c,d,k,aj[aa+9],al,568446438);k=aF(k,b,c,d,aj[aa+14],am,3275163606);d=aF(d,k,b,c,aj[aa+3],an,4107603335);c=aF(c,d,k,b,aj[aa+8],ao,1163531501);b=aF(b,c,d,k,aj[aa+13],al,2850285829);k=aF(k,b,c,d,aj[aa+2],am,4243563512);d=aF(d,k,b,c,aj[aa+7],an,1735328473);c=aF(c,d,k,b,aj[aa+12],ao,2368359562);b=ai(b,c,d,k,aj[aa+5],ax,4294588738);k=ai(k,b,c,d,aj[aa+8],az,2272392833);d=ai(d,k,b,c,aj[aa+11],aA,1839030562);c=ai(c,d,k,b,aj[aa+14],aB,4259657740);b=ai(b,c,d,k,aj[aa+1],ax,2763975236);k=ai(k,b,c,d,aj[aa+4],az,1272893353);d=ai(d,k,b,c,aj[aa+7],aA,4139469664);c=ai(c,d,k,b,aj[aa+10],aB,3200236656);b=ai(b,c,d,k,aj[aa+13],ax,681279174);k=ai(k,b,c,d,aj[aa+0],az,3936430074);d=ai(d,k,b,c,aj[aa+3],aA,3572445317);c=ai(c,d,k,b,aj[aa+6],aB,76029189);b=ai(b,c,d,k,aj[aa+9],ax,3654602809);k=ai(k,b,c,d,aj[aa+12],az,3873151461);d=ai(d,k,b,c,aj[aa+15],aA,530742520);c=ai(c,d,k,b,aj[aa+2],aB,3299628645);b=ar(b,c,d,k,aj[aa+0],F,4096336452);k=ar(k,b,c,d,aj[aa+7],G,1126891415);d=ar(d,k,b,c,aj[aa+14],I,2878612391);c=ar(c,d,k,b,aj[aa+5],ab,4237533241);b=ar(b,c,d,k,aj[aa+12],F,1700485571);k=ar(k,b,c,d,aj[aa+3],G,2399980690);d=ar(d,k,b,c,aj[aa+10],I,4293915773);c=ar(c,d,k,b,aj[aa+1],ab,2240044497);b=ar(b,c,d,k,aj[aa+8],F,1873313359);k=ar(k,b,c,d,aj[aa+15],G,4264355552);d=ar(d,k,b,c,aj[aa+6],I,2734768916);c=ar(c,d,k,b,aj[aa+13],ab,1309151649);b=ar(b,c,d,k,aj[aa+4],F,4149444226);k=ar(k,b,c,d,aj[aa+11],G,3174756917);d=ar(d,k,b,c,aj[aa+2],I,718787259);c=ar(c,d,k,b,aj[aa+9],ab,3951481745);b=af(b,aD);c=af(c,ah);d=af(d,ap);k=af(k,aE)}var aC=ak(b)+ak(c)+ak(d)+ak(k);return aC.toLowerCase()}});fluid.module.define("fluid.util",function(c){var z=c;var l=z._;var G={};var F=Array.prototype,g=Object.prototype,s=Function.prototype;var J=F.push,p=F.slice,B=F.concat,e=g.toString,k=g.hasOwnProperty;var N=F.forEach,r=F.map,H=F.reduce,d=F.reduceRight,b=F.filter,E=F.every,q=F.some,o=F.indexOf,m=F.lastIndexOf,v=Array.isArray,f=Object.keys,I=s.bind;var O=function(P){if(P instanceof O){return P}if(!(this instanceof O)){return new O(P)}this._wrapped=P};if(typeof exports!=="undefined"){if(typeof c!=="undefined"&&c.exports){exports=c.exports=O}exports._=O}else{z._=O}O.VERSION="1.4.4";var K=O.each=O.forEach=function(U,T,S){if(U==null){return}if(N&&U.forEach===N){U.forEach(T,S)}else{if(U.length===+U.length){for(var R=0,P=U.length;R<P;R++){if(T.call(S,U[R],R,U)===G){return}}}else{for(var Q in U){if(O.has(U,Q)){if(T.call(S,U[Q],Q,U)===G){return}}}}}};O.map=O.collect=function(S,R,Q){var P=[];if(S==null){return P}if(r&&S.map===r){return S.map(R,Q)}K(S,function(V,T,U){P[P.length]=R.call(Q,V,T,U)});return P};var h="Reduce of empty array with no initial value";O.reduce=O.foldl=O.inject=function(T,S,P,R){var Q=arguments.length>2;if(T==null){T=[]}if(H&&T.reduce===H){if(R){S=O.bind(S,R)}return Q?T.reduce(S,P):T.reduce(S)}K(T,function(W,U,V){if(!Q){P=W;Q=true}else{P=S.call(R,P,W,U,V)}});if(!Q){throw new TypeError(h)}return P};O.reduceRight=O.foldr=function(V,S,P,R){var Q=arguments.length>2;if(V==null){V=[]}if(d&&V.reduceRight===d){if(R){S=O.bind(S,R)}return Q?V.reduceRight(S,P):V.reduceRight(S)}var U=V.length;if(U!==+U){var T=O.keys(V);U=T.length}K(V,function(Y,W,X){W=T?T[--U]:--U;if(!Q){P=V[W];Q=true}else{P=S.call(R,P,V[W],W,X)}});if(!Q){throw new TypeError(h)}return P};O.find=O.detect=function(S,R,Q){var P;D(S,function(V,T,U){if(R.call(Q,V,T,U)){P=V;return true}});return P};O.filter=O.select=function(S,R,Q){var P=[];if(S==null){return P}if(b&&S.filter===b){return S.filter(R,Q)}K(S,function(V,T,U){if(R.call(Q,V,T,U)){P[P.length]=V}});return P};O.reject=function(R,Q,P){return O.filter(R,function(U,S,T){return !Q.call(P,U,S,T)},P)};O.every=O.all=function(S,R,Q){R||(R=O.identity);var P=true;if(S==null){return P}if(E&&S.every===E){return S.every(R,Q)}K(S,function(V,T,U){if(!(P=P&&R.call(Q,V,T,U))){return G}});return !!P};var D=O.some=O.any=function(S,R,Q){R||(R=O.identity);var P=false;if(S==null){return P}if(q&&S.some===q){return S.some(R,Q)}K(S,function(V,T,U){if(P||(P=R.call(Q,V,T,U))){return G}});return !!P};O.contains=O.include=function(Q,P){if(Q==null){return false}if(o&&Q.indexOf===o){return Q.indexOf(P)!=-1}return D(Q,function(R){return R===P})};O.invoke=function(R,S){var P=p.call(arguments,2);var Q=O.isFunction(S);return O.map(R,function(T){return(Q?S:T[S]).apply(T,P)})};O.pluck=function(Q,P){return O.map(Q,function(R){return R[P]})};O.where=function(Q,P,R){if(O.isEmpty(P)){return R?null:[]}return O[R?"find":"filter"](Q,function(T){for(var S in P){if(P[S]!==T[S]){return false}}return true})};O.findWhere=function(Q,P){return O.where(Q,P,true)};O.max=function(S,R,Q){if(!R&&O.isArray(S)&&S[0]===+S[0]&&S.length<65535){return Math.max.apply(Math,S)}if(!R&&O.isEmpty(S)){return -Infinity}var P={computed:-Infinity,value:-Infinity};K(S,function(W,T,V){var U=R?R.call(Q,W,T,V):W;U>=P.computed&&(P={value:W,computed:U})});return P.value};O.min=function(S,R,Q){if(!R&&O.isArray(S)&&S[0]===+S[0]&&S.length<65535){return Math.min.apply(Math,S)}if(!R&&O.isEmpty(S)){return Infinity}var P={computed:Infinity,value:Infinity};K(S,function(W,T,V){var U=R?R.call(Q,W,T,V):W;U<P.computed&&(P={value:W,computed:U})});return P.value};O.shuffle=function(S){var R;var Q=0;var P=[];K(S,function(T){R=O.random(Q++);P[Q-1]=P[R];P[R]=T});return P};var a=function(P){return O.isFunction(P)?P:function(Q){return Q[P]}};O.sortBy=function(S,R,P){var Q=a(R);return O.pluck(O.map(S,function(V,T,U){return{value:V,index:T,criteria:Q.call(P,V,T,U)}}).sort(function(W,V){var U=W.criteria;var T=V.criteria;if(U!==T){if(U>T||U===void 0){return 1}if(U<T||T===void 0){return -1}}return W.index<V.index?-1:1}),"value")};var u=function(U,T,Q,S){var P={};var R=a(T||O.identity);K(U,function(X,V){var W=R.call(Q,X,V,U);S(P,W,X)});return P};O.groupBy=function(R,Q,P){return u(R,Q,P,function(S,T,U){(O.has(S,T)?S[T]:(S[T]=[])).push(U)})};O.countBy=function(R,Q,P){return u(R,Q,P,function(S,T){if(!O.has(S,T)){S[T]=0}S[T]++})};O.sortedIndex=function(W,V,S,R){S=S==null?O.identity:a(S);var U=S.call(R,V);var P=0,T=W.length;while(P<T){var Q=(P+T)>>>1;S.call(R,W[Q])<U?P=Q+1:T=Q}return P};O.toArray=function(P){if(!P){return[]}if(O.isArray(P)){return p.call(P)}if(P.length===+P.length){return O.map(P,O.identity)}return O.values(P)};O.size=function(P){if(P==null){return 0}return(P.length===+P.length)?P.length:O.keys(P).length};O.first=O.head=O.take=function(R,Q,P){if(R==null){return void 0}return(Q!=null)&&!P?p.call(R,0,Q):R[0]};O.initial=function(R,Q,P){return p.call(R,0,R.length-((Q==null)||P?1:Q))};O.last=function(R,Q,P){if(R==null){return void 0}if((Q!=null)&&!P){return p.call(R,Math.max(R.length-Q,0))}else{return R[R.length-1]}};O.rest=O.tail=O.drop=function(R,Q,P){return p.call(R,(Q==null)||P?1:Q)};O.compact=function(P){return O.filter(P,O.identity)};var A=function(Q,R,P){K(Q,function(S){if(O.isArray(S)){R?J.apply(P,S):A(S,R,P)}else{P.push(S)}});return P};O.flatten=function(Q,P){return A(Q,P,[])};O.without=function(P){return O.difference(P,p.call(arguments,1))};O.uniq=O.unique=function(V,U,T,S){if(O.isFunction(U)){S=T;T=U;U=false}var Q=T?O.map(V,T,S):V;var R=[];var P=[];K(Q,function(X,W){if(U?(!W||P[P.length-1]!==X):!O.contains(P,X)){P.push(X);R.push(V[W])}});return R};O.union=function(){return O.uniq(B.apply(F,arguments))};O.intersection=function(Q){var P=p.call(arguments,1);return O.filter(O.uniq(Q),function(R){return O.every(P,function(S){return O.indexOf(S,R)>=0})})};O.difference=function(Q){var P=B.apply(F,p.call(arguments,1));return O.filter(Q,function(R){return !O.contains(P,R)})};O.zip=function(){var P=p.call(arguments);var S=O.max(O.pluck(P,"length"));var R=new Array(S);for(var Q=0;Q<S;Q++){R[Q]=O.pluck(P,""+Q)}return R};O.object=function(T,R){if(T==null){return{}}var P={};for(var S=0,Q=T.length;S<Q;S++){if(R){P[T[S]]=R[S]}else{P[T[S][0]]=T[S][1]}}return P};O.indexOf=function(T,R,S){if(T==null){return -1}var Q=0,P=T.length;if(S){if(typeof S=="number"){Q=(S<0?Math.max(0,P+S):S)}else{Q=O.sortedIndex(T,R);return T[Q]===R?Q:-1}}if(o&&T.indexOf===o){return T.indexOf(R,S)}for(;Q<P;Q++){if(T[Q]===R){return Q}}return -1};O.lastIndexOf=function(T,R,S){if(T==null){return -1}var P=S!=null;if(m&&T.lastIndexOf===m){return P?T.lastIndexOf(R,S):T.lastIndexOf(R)}var Q=(P?S:T.length);while(Q--){if(T[Q]===R){return Q}}return -1};O.range=function(U,S,T){if(arguments.length<=1){S=U||0;U=0}T=arguments[2]||1;var Q=Math.max(Math.ceil((S-U)/T),0);var P=0;var R=new Array(Q);while(P<Q){R[P++]=U;U+=T}return R};O.bind=function(R,Q){if(R.bind===I&&I){return I.apply(R,p.call(arguments,1))}var P=p.call(arguments,2);return function(){return R.apply(Q,P.concat(p.call(arguments)))}};O.partial=function(Q){var P=p.call(arguments,1);return function(){return Q.apply(this,P.concat(p.call(arguments)))}};O.bindAll=function(Q){var P=p.call(arguments,1);if(P.length===0){P=O.functions(Q)}K(P,function(R){Q[R]=O.bind(Q[R],Q)});return Q};O.memoize=function(R,Q){var P={};Q||(Q=O.identity);return function(){var S=Q.apply(this,arguments);return O.has(P,S)?P[S]:(P[S]=R.apply(this,arguments))}};O.delay=function(Q,R){var P=p.call(arguments,2);return setTimeout(function(){return Q.apply(null,P)},R)};O.defer=function(P){return O.delay.apply(O,[P,1].concat(p.call(arguments,1)))};O.throttle=function(U,W){var S,R,V,P;var T=0;var Q=function(){T=new Date;V=null;P=U.apply(S,R)};return function(){var X=new Date;var Y=W-(X-T);S=this;R=arguments;if(Y<=0){clearTimeout(V);V=null;T=X;P=U.apply(S,R)}else{if(!V){V=setTimeout(Q,Y)}}return P}};O.debounce=function(R,T,Q){var S,P;return function(){var X=this,W=arguments;var V=function(){S=null;if(!Q){P=R.apply(X,W)}};var U=Q&&!S;clearTimeout(S);S=setTimeout(V,T);if(U){P=R.apply(X,W)}return P}};O.once=function(R){var P=false,Q;return function(){if(P){return Q}P=true;Q=R.apply(this,arguments);R=null;return Q}};O.wrap=function(P,Q){return function(){var R=[P];J.apply(R,arguments);return Q.apply(this,R)}};O.compose=function(){var P=arguments;return function(){var Q=arguments;for(var R=P.length-1;R>=0;R--){Q=[P[R].apply(this,Q)]}return Q[0]}};O.after=function(Q,P){if(Q<=0){return P()}return function(){if(--Q<1){return P.apply(this,arguments)}}};O.keys=f||function(R){if(R!==Object(R)){throw new TypeError("Invalid object")}var Q=[];for(var P in R){if(O.has(R,P)){Q[Q.length]=P}}return Q};O.values=function(R){var P=[];for(var Q in R){if(O.has(R,Q)){P.push(R[Q])}}return P};O.pairs=function(R){var Q=[];for(var P in R){if(O.has(R,P)){Q.push([P,R[P]])}}return Q};O.invert=function(R){var P={};for(var Q in R){if(O.has(R,Q)){P[R[Q]]=Q}}return P};O.functions=O.methods=function(R){var Q=[];for(var P in R){if(O.isFunction(R[P])){Q.push(P)}}return Q.sort()};O.extend=function(P){K(p.call(arguments,1),function(Q){if(Q){for(var R in Q){P[R]=Q[R]}}});return P};O.pick=function(Q){var R={};var P=B.apply(F,p.call(arguments,1));K(P,function(S){if(S in Q){R[S]=Q[S]}});return R};O.omit=function(R){var S={};var Q=B.apply(F,p.call(arguments,1));for(var P in R){if(!O.contains(Q,P)){S[P]=R[P]}}return S};O.defaults=function(P){K(p.call(arguments,1),function(Q){if(Q){for(var R in Q){if(P[R]==null){P[R]=Q[R]}}}});return P};O.clone=function(P){if(!O.isObject(P)){return P}return O.isArray(P)?P.slice():O.extend({},P)};O.tap=function(Q,P){P(Q);return Q};var L=function(W,V,Q,R){if(W===V){return W!==0||1/W==1/V}if(W==null||V==null){return W===V}if(W instanceof O){W=W._wrapped}if(V instanceof O){V=V._wrapped}var T=e.call(W);if(T!=e.call(V)){return false}switch(T){case"[object String]":return W==String(V);case"[object Number]":return W!=+W?V!=+V:(W==0?1/W==1/V:W==+V);case"[object Date]":case"[object Boolean]":return +W==+V;case"[object RegExp]":return W.source==V.source&&W.global==V.global&&W.multiline==V.multiline&&W.ignoreCase==V.ignoreCase}if(typeof W!="object"||typeof V!="object"){return false}var P=Q.length;while(P--){if(Q[P]==W){return R[P]==V}}Q.push(W);R.push(V);var Y=0,Z=true;if(T=="[object Array]"){Y=W.length;Z=Y==V.length;if(Z){while(Y--){if(!(Z=L(W[Y],V[Y],Q,R))){break}}}}else{var U=W.constructor,S=V.constructor;if(U!==S&&!(O.isFunction(U)&&(U instanceof U)&&O.isFunction(S)&&(S instanceof S))){return false}for(var X in W){if(O.has(W,X)){Y++;if(!(Z=O.has(V,X)&&L(W[X],V[X],Q,R))){break}}}if(Z){for(X in V){if(O.has(V,X)&&!(Y--)){break}}Z=!Y}}Q.pop();R.pop();return Z};O.isEqual=function(Q,P){return L(Q,P,[],[])};O.isEmpty=function(Q){if(Q==null){return true}if(O.isArray(Q)||O.isString(Q)){return Q.length===0}for(var P in Q){if(O.has(Q,P)){return false}}return true};O.isElement=function(P){return !!(P&&P.nodeType===1)};O.isArray=v||function(P){return e.call(P)=="[object Array]"};O.isObject=function(P){return P===Object(P)};K(["Arguments","Function","String","Number","Date","RegExp"],function(P){O["is"+P]=function(Q){return e.call(Q)=="[object "+P+"]"}});if(!O.isArguments(arguments)){O.isArguments=function(P){return !!(P&&O.has(P,"callee"))}}if(typeof(/./)!=="function"){O.isFunction=function(P){return typeof P==="function"}}O.isFinite=function(P){return isFinite(P)&&!isNaN(parseFloat(P))};O.isNaN=function(P){return O.isNumber(P)&&P!=+P};O.isBoolean=function(P){return P===true||P===false||e.call(P)=="[object Boolean]"};O.isNull=function(P){return P===null};O.isUndefined=function(P){return P===void 0};O.has=function(Q,P){return k.call(Q,P)};O.noConflict=function(){z._=l;return this};O.identity=function(P){return P};O.times=function(T,S,R){var P=Array(T);for(var Q=0;Q<T;Q++){P[Q]=S.call(R,Q)}return P};O.random=function(Q,P){if(P==null){P=Q;Q=0}return Q+Math.floor(Math.random()*(P-Q+1))};var n={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};n.unescape=O.invert(n.escape);var M={escape:new RegExp("["+O.keys(n.escape).join("")+"]","g"),unescape:new RegExp("("+O.keys(n.unescape).join("|")+")","g")};O.each(["escape","unescape"],function(P){O[P]=function(Q){if(Q==null){return""}return(""+Q).replace(M[P],function(R){return n[P][R]})}});O.result=function(P,R){if(P==null){return null}var Q=P[R];return O.isFunction(Q)?Q.call(P):Q};O.mixin=function(P){K(O.functions(P),function(Q){var R=O[Q]=P[Q];O.prototype[Q]=function(){var S=[this._wrapped];J.apply(S,arguments);return t.call(this,R.apply(O,S))}})};var C=0;O.uniqueId=function(P){var Q=++C+"";return P?P+Q:Q};O.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var w=/(.)^/;var i={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};var j=/\\|'|\r|\n|\t|\u2028|\u2029/g;O.template=function(X,S,R){var Q;R=O.defaults({},R,O.templateSettings);var T=new RegExp([(R.escape||w).source,(R.interpolate||w).source,(R.evaluate||w).source].join("|")+"|$","g");var U=0;var P="__p+='";X.replace(T,function(Z,aa,Y,ac,ab){P+=X.slice(U,ab).replace(j,function(ad){return"\\"+i[ad]});if(aa){P+="'+\n((__t=("+aa+"))==null?'':_.escape(__t))+\n'"}if(Y){P+="'+\n((__t=("+Y+"))==null?'':__t)+\n'"}if(ac){P+="';\n"+ac+"\n__p+='"}U=ab+Z.length;return Z});P+="';\n";if(!R.variable){P="with(obj||{}){\n"+P+"}\n"}P="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+P+"return __p;\n";try{Q=new Function(R.variable||"obj","_",P)}catch(V){V.source=P;throw V}if(S){return Q(S,O)}var W=function(Y){return Q.call(this,Y,O)};W.source="function("+(R.variable||"obj")+"){\n"+P+"}";return W};O.chain=function(P){return O(P).chain()};var t=function(P){return this._chain?O(P).chain():P};O.mixin(O);K(["pop","push","reverse","shift","sort","splice","unshift"],function(P){var Q=F[P];O.prototype[P]=function(){var R=this._wrapped;Q.apply(R,arguments);if((P=="shift"||P=="splice")&&R.length===0){delete R[0]}return t.call(this,R)}});K(["concat","join","slice"],function(P){var Q=F[P];O.prototype[P]=function(){return t.call(this,Q.apply(this._wrapped,arguments))}});O.extend(O.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})});fluid.module.define("fluid.event",function(b){b.mixinTo=function(e){var f={};var c=typeof e=="object";function d(i,j){var i=i.split(/,\s*|\s+/);for(var h=0,g=i.length;h<g;h++){j.call(e,i[h])}}e.bind=e.on=function(i,h,g){d(i,function(k){var j=f[k]||(f[k]=[]);if(a(j,h)==-1){j.push({h:h,c:g||this,evtName:k})}});return this};e.unbind=e.off=function(h,g){d(h,function(k){var j=f[k];if(j){var i=a(j,g);if(i>-1){j.splice(i,1)}}});return this};e.trigger=e.fire=function(){var k,j=arguments[0],i=f[j],m=f.all;if(i){k=Array.prototype.slice.call(arguments,1);if(c){k.unshift(this)}for(var h=0,g=i.length;h<g;h++){var l=i[h];if(l.h.apply(l.c,k)===false){return false}}if(c){k.shift()}}if(m){for(h=0,g=m.length;h<g;h++){var l=m[h];if(l.h.apply(l.c,arguments)===false){return false}}}return true}};function a(e,f){for(var d=0,c=e.length;d<c;d++){if(e[d].h===f){return d}}return -1}});fluid.module.define("fluid.main",function(a){fluid.event.mixinTo(a);a.listProjects=function(){if(!fluid.main.projects.length){console.info("no projects found...")}fluid.main.projects.each(function(d,c,f){var b=d.get("pages"),e=d.get("unloaded"),g=d.get("id");if(g===fluid.main.project.get("id")){console.info(c,d.get("id"),e?"unloaded":"loaded",(b&&b.length)?b.length:0,d.toJSON({getAll:true}),fluid.main.project==d)}else{console.log(c,d.get("id"),e?"unloaded":"loaded",(b&&b.length)?b.length:0,d.toJSON({getAll:true}))}})}});(function(c){var f=[];var b=f.push;var d=f.slice;var e=f.splice;fluid.Collection=function(h,g){fluid.event.mixinTo(this);g||(g={});if(g.model){this.model=g.model}if(g.comparator!==void 0){this.comparator=g.comparator}this._reset();this.initialize.apply(this,arguments);if(h){this.reset(h,c.extend({silent:true},g))}this.afterInit.apply(this,arguments)};fluid.Collection.prototype.setOptions={add:true,remove:true,merge:false};fluid.Collection.prototype.addOptions={add:true,remove:false};fluid.Collection.prototype.afterInit=function(){};fluid.Collection.prototype.add=function(h,g){return this.set(h,c.extend({merge:false},g,this.addOptions))};fluid.Collection.prototype.set=function(z,h){h=c.defaults({},h,this.setOptions);if(h.parse){z=this.parse(z,h)}if(!c.isArray(z)){z=z?[z]:[]}var u,s,j,q,o,w;var m=h.at;var g=this.comparator&&(m==null)&&h.sort!==false;var v=c.isString(this.comparator)?this.comparator:null;var A=[],r=[],p={};var n=h.add,k=h.merge,B=h.remove;var t=!g&&n&&B?[]:false;for(u=0,s=z.length;u<s;u++){if(!(j=this._prepareModel(q=z[u],h))){continue}if(o=this.get(j)){if(B){p[o.cid]=true}if(k){q=q===j?j.attributes:h._attrs;o.set(q,h);if(g&&!w&&o.hasChanged(v)){w=true}}}else{if(n){A.push(j);j.on("all",this._onModelEvent,this);this._byId[j.cid]=j;if(j.id!=null){this._byId[j.id]=j}}}if(t){t.push(o||j)}delete h._attrs}if(B){for(u=0,s=this.length;u<s;++u){if(!p[(j=this.models[u]).cid]){r.push(j)}}if(r.length){this.remove(r,h)}}if(A.length||(t&&t.length)){if(g){w=true}this.length+=A.length;if(m!=null){e.apply(this.models,[m,0].concat(A))}else{if(t){this.models.length=0}b.apply(this.models,t||A)}}if(w){this.sort({silent:true})}if(h.silent){return this}for(u=0,s=A.length;u<s;u++){(j=A[u]).trigger("add",j,this,h)}if(w||(t&&t.length)){this.trigger("sort",this,h)}return this};fluid.Collection.prototype.get=function(g){if(g==null){return void 0}return this._byId[g.id]||this._byId[g.cid]||this._byId[g]};fluid.Collection.prototype.reset=function(k,h){h||(h={});for(var j=0,g=this.models.length;j<g;j++){this._removeReference(this.models[j])}h.previousModels=this.models;this._reset();this.add(k,c.extend({silent:true},h));if(!h.silent){this.trigger("reset",this,h)}return this};fluid.Collection.prototype._reset=function(){this.length=0;this.models=[];this._byId={}};fluid.Collection.prototype._prepareModel=function(i,h){if(i instanceof fluid.Model){if(!i.collection){i.collection=this}return i}h||(h={});h.collection=this;var g=new this.model(i,h);if(!g.validationError){return g}this.trigger("invalid",this,i,h);return false};fluid.Collection.prototype._onModelEvent=function(i,h,j,g){if((i==="add"||i==="remove")&&j!==this){return}if(i==="destroy"){this.remove(h,g)}if(h&&i==="change:"+h.idAttribute){delete this._byId[h.previous(h.idAttribute)];if(h.id!=null){this._byId[h.id]=h}}this.trigger.apply(this,arguments)};fluid.Collection.prototype._removeReference=function(g){if(this===g.collection){delete g.collection}g.off("all",this._onModelEvent,this)};fluid.Collection.prototype.toJSON=function(h){var g={};this.forEach(function(i){g[i.attributes[i.idAttribute]]=i.toJSON(h)});return g};fluid.Collection.prototype.allToJSON=function(h){var g={};this.forEach(function(i){g[i.attributes[i.idAttribute]]=i.allToJSON(h)});return g};var a=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];c.each(a,function(g){fluid.Collection.prototype[g]=function(){var h=d.call(arguments);h.unshift(this.models);return c[g].apply(c,h)}});fluid.Collection.prototype.remove=function(n,k){n=c.isArray(n)?n.slice():[n];k||(k={});var m,g,j,h;for(m=0,g=n.length;m<g;m++){h=this.get(n[m]);if(!h){continue}delete this._byId[h.id];delete this._byId[h.cid];j=this.indexOf(h);this.models.splice(j,1);this.length--;if(!k.silent){k.index=j;h.trigger("remove",h,this,k)}this._removeReference(h)}return this};fluid.Collection.prototype.where=function(g,h){if(c.isEmpty(g)){return h?void 0:[]}return this[h?"find":"filter"](function(i){for(var j in g){if(g[j]!==i.get(j)){return false}}return true})};fluid.Collection.prototype.at=function(g){if(g<0){g+=this.length}return this.models[g]};fluid.Collection.prototype.clone=function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})}})(fluid.util._);(function(b){var g=[];var a=g.push;var d=g.slice;var f=g.splice;fluid.Model=function(h,j){fluid.event.mixinTo(this);var i=h||{};j||(j={});this.cid=b.uniqueId("c");this.attributes={};if(j.collection){this.collection=j.collection}if(j.parse){i=this.parse(i,j)||{}}if(defaults=b.result(this,"defaults")){i=b.defaults({},i,defaults)}this.set(i,j);this.initialize.apply(this,arguments)};fluid.Model.prototype.idAttribute="id";fluid.Model.prototype.attrBlackList=[];fluid.Model.prototype.parse=function(i,h){return i};fluid.Model.prototype.toJSON=function(h){if(h&&h.getAll){return b.clone(this.attributes)}return b.omit(this.attributes,this.attrBlackList)};fluid.Model.prototype.allToJSON=function(h){return b.clone(this.attributes)};fluid.Model.prototype._validate=function(i,h){return true};fluid.Model.prototype.get=function(h){return this.attributes[h]},fluid.Model.prototype.set=function(r,h,v){var p,s,t,q,o,u,k,n;if(r==null){return this}if(typeof r==="object"){s=r;v=h}else{(s={})[r]=h}v||(v={});if(!this._validate(s,v)){return false}t=v.unset;o=v.silent;q=[];u=this._changing;this._changing=true;if(!u){this._previousAttributes=b.clone(this.attributes);this.changed={}}n=this.attributes,k=this._previousAttributes;if(this.idAttribute in s){this.id=s[this.idAttribute]}for(p in s){h=s[p];if(!b.isEqual(n[p],h)){q.push(p)}if(!b.isEqual(k[p],h)){this.changed[p]=h}else{delete this.changed[p]}t?delete n[p]:n[p]=h}if(!o){if(q.length){this._pending=true}for(var m=0,j=q.length;m<j;m++){this.trigger("change:"+q[m],this,n[q[m]],v)}}if(u){return this}if(!o){while(this._pending){this._pending=false;this.trigger("change",this,v)}}this._pending=false;this._changing=false;return this};fluid.Model.prototype.unset=function(h,i){return this.set(h,void 0,b.extend({},i,{unset:true}))};fluid.Model.prototype.hasChanged=function(h){if(h==null){return !b.isEmpty(this.changed)}return b.has(this.changed,h)};fluid.Model.prototype.changedAttributes=function(j){if(!j){return this.hasChanged()?b.clone(this.changed):false}var l,k=false;var i=this._changing?this._previousAttributes:this.attributes;for(var h in j){if(b.isEqual(i[h],(l=j[h]))){continue}(k||(k={}))[h]=l}return k};fluid.Model.prototype.previous=function(h){if(h==null||!this._previousAttributes){return null}return this._previousAttributes[h]};fluid.Model.prototype.previousAttributes=function(){return b.clone(this._previousAttributes)};var c=["keys","values","pairs","invert","pick","omit"];b.each(c,function(h){fluid.Model.prototype[h]=function(){var i=d.call(arguments);i.unshift(this.attributes);return b[h].apply(b,i)}});var e=function(h,j){var i=this;var l;if(h&&b.has(h,"constructor")){l=h.constructor}else{l=function(){return i.apply(this,arguments)}}b.extend(l,i,j);var k=function(){this.constructor=l};k.prototype=i.prototype;l.prototype=new k;if(h){b.extend(l.prototype,h)}l.__super__=i.prototype;return l};fluid.Model.extend=e;fluid.Collection.extend=e})(fluid.util._);fluid.objectCompare=function(d,c,e){return fluid.eq(d,c,[],[],e)};(function(a){fluid.eq=function(k,j,d,e,o){var f=o&&o.silent?true:false;if(k===j){return k!==0||1/k==1/j}if(k==null||j==null){return k===j}if(k instanceof a){k=k._wrapped}if(j instanceof a){j=j._wrapped}var h=toString.call(k);if(!f&&h!=toString.call(j)){console.log("!!! compare fail, a: ",d);console.log("!!! b: ",e);return false}switch(h){case"[object String]":return k==String(j);case"[object Number]":return k!=+k?j!=+j:(k==0?1/k==1/j:k==+j);case"[object Date]":case"[object Boolean]":return +k==+j;case"[object RegExp]":return k.source==j.source&&k.global==j.global&&k.multiline==j.multiline&&k.ignoreCase==j.ignoreCase}if(!f&&(typeof k!="object"||typeof j!="object")){console.log("!!! compare fail, a: ",d);console.log("!!! b: ",e);return false}var c=d.length;while(c--){if(d[c]==k){return e[c]==j}}var i=k.constructor,g=j.constructor;if(!f&&i!==g&&!(a.isFunction(i)&&(i instanceof i)&&a.isFunction(g)&&(g instanceof g))){console.log("!!! compare fail, a: ",d);console.log("!!! b: ",e);return false}d.push(k);e.push(j);var n=0,m=true;if(h=="[object Array]"){n=k.length;m=n==j.length;if(m){while(n--){if(!f&&!(m=fluid.eq(k[n],j[n],d,e,o))){console.log("!!! compare fail: ",d,l,k[l],j[l]);break}}}}else{for(var l in k){if(a.has(k,l)){n++;m=(a.has(j,l)&&fluid.eq(k[l],j[l],d,e,o))||(a.has(j,l)&&(l=="updated")||(l=="saved")||(l=="createDate")||(l=="created")||(l=="wh")||(l=="insertAfterId"));if(!f&&!m){console.log("!!! compare fail: ",d,l,k[l],j[l]);break}}}if(m){for(l in j){if(l==="updated"&&!a.has(k,l)){if(!(n)){break}}else{if(a.has(j,l)&&!(n--)){break}}}m=!n;if(!f&&!m){console.log("!!! compare fail: ",d,l,k[l],j[l])}}}d.pop();e.pop();return m}})(fluid.util._);fluid.module.define("fluid.model",function(c){var a={storage:window.storage};var d="fluid.models";var b={};b.store=function(e){e=e||this.id;if(e){a.storage.set(e,this);this.trigger("change")}return this};b.fetch=function(g){g=g||this.id;var e=a.storage.get(g);if(e){for(var f in e){this[f]=e[f]}}return this};b.remove=function(e){e=e||this.id;a.storage.remove(e);return this};b.validate=function(){};fluid.event.mixinTo(b);c.define=function(f,e){if(!e){e=function(){}}e.prototype=b;fluid.module.define(d)[f]=e;e.fetch=function(g){return new e().fetch(g)};e.remove=function(g){e.prototype.remove.call(null,g)};fluid.event.mixinTo(e)}});if(!fluid.models){fluid.models={}}(function(a){fluid.models.Account=fluid.Model.extend({_type:"accountModel",attrBlackList:["accountId"],idAttribute:"accountId",defaults:{email:"New",accType:"New",name:"",recurrance:"never",libraryWidth:423,loggedIn:"no",maxActiveProjects:1,maxPages:10,projectIds:[],uploads:[],lastOpenProject:"",createDate:new Date().getTime()},initialize:function(b,c){this.on("all",this.onChange,this);if(!this.customwidgets){this.customwidgets=new fluid.CustomWidgets(null,{accountModel:this})}},onChange:function(){if(!this.debouncedSave){this.debouncedSave=a.debounce(this.save,50)}this.debouncedSave.apply(this,arguments)},parse:function(g,c){if(!g){return{}}var e=["a","r","sessionId","settings","objects","intercomUserHash","lastProjectId","upgradeDate","lastPaymentDate","nextPaymentDate","lastPaymentResult"],b=["maxActiveProjects","maxPages"],f,d;f=fluid.util._.omit(g,e);for(d=0;d<b.length;d++){if(f[b[d]]!==undefined){f[b[d]]=~~f[b[d]]}}return f},bundle:function(){var b=["hint","tutorialLevel","billingCompany","billingCountry","billingAddress","billingVAT","gridStatus","gridSpacing","snapToWidget","receiptEmails","emailReceiptEnabled","lastOpenProject"];return this.pick(b)},save:function(){var c=this.allToJSON();var b={id:this.get("accountId"),data:c};dbStorage.set("accounts",b)}})})(fluid.util._);if(!fluid.models){fluid.models={}}(function(a){fluid.models.Upload=fluid.Model.extend({attrBlackList:["imgData"],initialize:function(b,c){this.on("change",function(){var d=a.keys(this.changedAttributes());if(d.indexOf("imgData")!==-1){dbStorage.set("uploads",{id:this.id,data:this.get("imgData")})}},this)},parse:function(c,b){return c}});fluid.Uploads=fluid.Collection.extend({model:fluid.models.Upload,_type:"upload",initialize:function(c,b){this.on("all",this.onChange,this)},afterInit:function(c,b){if(b&&b.saveAfterInit){this.save()}},onChange:function(){if(!this.debouncedSave){this.debouncedSave=fluid.util._.debounce(this.save,300)}this.debouncedSave.apply(this)},save:function(){dbStorage.set("uploadHeaders",{id:fluid.main.account.id,data:this.toJSON()})}})})(fluid.util._);if(!fluid.models){fluid.models={}}(function(a){fluid.models.project=fluid.Model.extend({attrBlackList:["visiblePages"],silentSyncAttrs:["updated","saved","preview","canvasPosX","canvasPosY","currentZoom","visiblePages"],silentSaveAttrs:["updated","saved","currentZoom"],initialize:function(b,c){if(!this.get("id")){if(c.projectId){this.set("id",c.projectId);this.id=c.projectId}}if(!this.pages){this.pages=new fluid.Pages(null,{projectModel:this})}if(!this.widgets){this.widgets=new fluid.Widgets(null,{projectModel:this})}if(!this.links){this.links=new fluid.Links(null,{projectModel:this})}if(!this.wdgGroups){this.wdgGroups=new fluid.WidgetGroups(null,{projectModel:this})}if(c&&c.syncOnChange!==false){this.pages.on("all",this.onChange,this);this.widgets.on("all",this.onChange,this);this.links.on("all",this.onChange,this);this.on("all",this.onChange,this);this.save()}fluid.main.on("thumbnailReady",function(d,e){if(e===this.id){this.modifiedSinceThumb=false}},this)},onChange:function(f,c){if(!c.changedAttributes){return}var b=c.changedAttributes(),e,d;if(b){b=a.keys(b);e=a.difference(b,this.silentSyncAttrs);d=a.difference(b,this.silentSaveAttrs);if(e.length){project.setModified(true);this.modifiedSinceThumb=true}if(d.length){if(!this.debouncedSave){this.debouncedSave=a.debounce(this.save,50)}this.debouncedSave.apply(this,arguments)}}},save:function(c){var b=this.bundle({getAll:true});dbStorage.set("projects",{id:this.id,data:b},function(){if(c&&c.call){c()}})},parse:function(o,b){var q;if(typeof o==="string"){o=JSON.parse(o)}if(b.projectId&&o[b.projectId]){q=o[b.projectId];q.id=b.projectId}else{var f=this.findProjectInBundle(o)[1];q=f[1];q.id=f[0]}var c=q.pages,h,m=[],p=[],u,s,t,v,n,w,e,d;if(c&&c.length){for(u=0,s=c.length;u<s;u++){n=c[u];if(!n){continue}if(o[n]){e=a.clone(o[n]);e.id=n;m.push(e);h=e.widgets;if(h.length){for(t=0,v=h.length;t<v;t++){w=h[t];if(o[w]&&o[w].lockTo&&!o[o[w].lockTo]){o[w]=null}if(o[w]&&o[w].of&&!o[o[w].of]){o[w]=null}if(fluid.main.uploads&&o[w]&&o[w].data&&!(o.uploads[o[w].data]&&fluid.main.uploads.get(o[w].data))){o[w]=null}if(o[w]){d=a.clone(o[w]);d.id=w;d.pageId=n;p.push(d)}else{h.splice(t,1);t--;v--}}}}else{c.splice(u,1);u--}}q.pages=c}else{q.pages=[]}if(q.homepage&&!o[q.homepage]){if(m.length){q.homepage=m[0].id}else{q.homepage=false}}this.pages=new fluid.Pages(m,{comparator:false,projectModel:this});this.widgets=new fluid.Widgets(p,{comparator:false,projectModel:this});var g=[],r,k;for(k in q.widgetGroups){if(q.widgetGroups.hasOwnProperty(k)){r={id:k,widgets:q.widgetGroups[k]}}g.push(r)}this.wdgGroups=new fluid.WidgetGroups(g,{comparator:false});this.links=new fluid.Links(null,{comparator:false});if(q.links){this.links.deserialize(q.links)}return q},get:function(c,g){var h=c.substr(0,1),d=g&&g.returnModel?true:false;if(c.substr(1,1)!=="_"&&this.attributes[c]!==undefined){return this.attributes[c]}else{if(h==="x"){var b=this.pages.get(c);if(!b){return false}return d?b:b.toJSON(g)}else{if(h==="w"){var f=this.widgets.get(c);if(!f){return false}return d?f:f.toJSON(g)}else{if(h==="l"){var e=this.links.get(c);if(!e){return false}return d?e:e.toJSON(g)}else{if(h==="p"){return d?this:this.toJSON(g)}}}}}},setChild:function(i,g){var b=i.substr(0,1);var c,f;if(b==="x"){f=this.pages;g.id=i;c=this.pages.get(i)}else{if(b=="w"){f=this.widgets;g.id=i;c=this.widgets.get(i)}else{if(b=="l"){f=this.links;c=this.links.get(i)}}}if(c){var e=fluid.util._.clone(c.attributes);for(var h in e){if(typeof g[h]==="undefined"&&e.hasOwnProperty(h)){var d=["id","pageId","box","imgData"];if(d.indexOf(h)!==-1){c.unset(h,{silent:true})}}}c.set(g)}else{f.add(g)}},findProjectInBundle:function(b){for(var c in b){if(b.hasOwnProperty(c)&&c.substr(0,2)==="p_"){return[c,b[c]]}}return false},bundle:function(c){var b={};b[this.attributes.id]=this.toJSON(c);if(this.links){a.extend(b[this.attributes.id],{links:this.links.toJSON(c)})}a.extend(b,this.pages?this.pages.toJSON(c):{});a.extend(b,this.widgets?this.widgets.toJSON(c):{});b.uploads={};if(this.widgets){this.widgets.each(function(e,d,h){if(!e.attributes.upload){return}var g=e.toJSON(),f;f=fluid.main.uploads.get(g.data).toJSON();b.uploads[g.data]=fluid.util._.pick(f,"type","wh","title")},this)}return b}});fluid.Projects=fluid.Collection.extend({model:fluid.models.project,initialize:function(c,b){}})})(fluid.util._);if(!fluid.models){fluid.models={}}(function(a){fluid.models.Page=fluid.Model.extend({attrBlackList:["id","box","imgData"],omitedRedrawAttrs:["x","y","imgData"],initialize:function(b,c){this.on("change:x change:y change:width change:height",function(){this.clearBox()},this);this.on("change",function(f,e){var d=this.changedAttributes(),g;d=a.keys(d);g=a.difference(d,this.omitedRedrawAttrs);if(g.length>0){this.clearImgData()}},this)},clearImgData:function(){this.set({imgData:null})},clearBox:function(){this.set({box:null},{silent:true})},getBox:function(){var b=this.get("box");if(b){return b}else{b=[this.get("x"),this.get("y"),this.get("width"),this.get("height")];this.set({box:b},{silent:true});return b}}});fluid.Pages=fluid.Collection.extend({model:fluid.models.Page,initialize:function(c,b){this.projectModel=b.projectModel}})})(fluid.util._);if(!fluid.models){fluid.models={}}(function(a){fluid.models.Widget=fluid.Model.extend({attrBlackList:["id","pageId","box"],initialize:function(b,c){this.on("change:tlwh",function(){this.clearBox()});this.on("change",function(){this.getPage().clearImgData()},this)},clearBox:function(){var b=this.getChildren();this.set({box:null},{silent:true});b.forEach(function(c,e,d){c.clearBox()})},calculateBox:function(f){var e=[],c=this.get("tlwh"),i=this.get("ca");var d=c[2]==null?0:c[2];if(d&&typeof(d)==="number"){e[2]=d}else{if(d&&d.indexOf("%")!==-1){e[2]=(parseFloat(d)/100)*f[2]}else{e[2]=f[2]}}var b=c[3]==null?0:c[3];if(b&&typeof(b)==="number"){e[3]=b}else{if(b&&b.indexOf("%")!==-1){e[3]=(parseFloat(b)/100)*f[3]}else{e[3]=f[3]}}var h=c[0]==null?0:c[0];if(!i||i[0]=="t"){if(typeof(h)==="number"){e[1]=h+f[1]}else{if(h.indexOf("%")!==-1){e[1]=((parseFloat(h)/100)*f[3])+f[1]}else{e[1]=parseInt(h,10)+f[1]}}}else{if(i[0]=="c"){if(typeof(h)==="number"){e[1]=h+f[1]+f[3]/2-e[3]/2}else{if(h.indexOf("%")!==-1){e[1]=((parseFloat(h)/100)*f[3])+f[1]+f[3]/2-e[3]/2}else{e[1]=parseInt(h,10)+f[1]+f[3]/2-e[3]/2}}}else{if(i[0]=="b"){if(typeof(h)==="number"){e[1]=f[1]+f[3]-h-e[3]}else{if(h.indexOf("%")!==-1){e[1]=f[1]+f[3]-((parseFloat(h)/100)*f[3])-e[3]}else{e[1]=f[1]+f[3]-parseInt(h,10)}}}}}var g=c[1]==null?0:c[1];if(!i||i[1]=="l"){if(typeof(g)==="number"||g.indexOf("%")===-1){e[0]=g+f[0]}else{if(g.indexOf("%")!==-1){e[0]=((parseFloat(g)/100)*f[2])+f[0]}else{e[0]=parseInt(g,10)+f[0]}}}else{if(i[1]=="c"){if(typeof(g)==="number"){e[0]=g+f[0]+f[2]/2-e[2]/2}else{if(g.indexOf("%")!==-1){e[0]=((parseFloat(g)/100)*f[2])+f[0]+f[2]/2-e[2]/2}else{e[0]=parseInt(g,10)+f[0]+f[2]/2}}}else{if(i[1]=="r"){if(typeof(g)==="number"){e[0]=f[0]+f[2]-g-e[2]}else{if(g.indexOf("%")!==-1){e[0]=f[0]+f[2]-((parseFloat(g)/100)*f[2])-e[2]}else{e[0]=f[0]+f[0]-parseInt(g,10)}}}}}e[0]=~~e[0];e[1]=~~e[1];e[2]=~~e[2];e[3]=~~e[3];this.set({box:e});return e},getBox:function(){var e,f,d,b,c,g;b=this.get("box");if(b){return b}if(!this.get("of")){c=this.get("st");f=this.getPage();if(c&&(c==="f"||c==="fb")){g=this.getProject().get("pageWH");if(f.get("orientation")==="Landscape"){g=[g[1],g[0]]}e=[0,0,g[0],g[1]]}else{e=[0,0,f.get("width"),f.get("height")]}}else{d=this.getParent();e=d.getBox()}b=this.calculateBox(e);return b},getRoot:function(){if(this.get("of")){return this.getParent().getRoot()}else{return this}},getDependents:function(){var b=this.collection.where({lockTo:this.id,of:this.id});return b},getLockTos:function(){var b=this.getRoot();var c=this.collection.where({lockTo:b.id});return c},getChildren:function(){var b=this.collection.where({of:this.id});return b},getParent:function(){return this.collection.get(this.get("of"))},getPage:function(){var b=this.getProject().pages.get(this.get("pageId"));if(this.get("pageId")&&b.get("widgets").indexOf(this.id)!==-1){return b}else{b=false;this.getProject().pages.every(function(e,d,c){if(e.get("widgets").indexOf(this.id)!==-1){b=e;this.set({pageId:e.id},{silent:true});return false}return true},this);return b}},getProject:function(){return this.collection.projectModel},containsText:function(c){var b=false;if(this.get("tc")){b=true}else{if(this.attributes.ad&&this.attributes.ad.length){this.attributes.ad.forEach(function(d){if(d&&d[0]){var f=d[0];var e=widgets.summary[f];if(e&&e.tc){b=true}}})}}return b},getSubTextElements:function(){var c=[],b=this.getDependents();b.forEach(function(d){c=c.concat(d.getSubTextElements())});if(this.get("tc")){c.push(this)}return c},getGroup:function(){var c=this.getProject().wdgGroups;var b=this.id;var d=c.find(function(e){if(e.get("widgets").indexOf(b)!==-1){return true}else{return false}});return d},getAllFromGroup:function(){var d=this.getGroup();var c=[];if(d){var b=d.get("widgets");c=fluid.main.project.widgets.filter(function(e){if(b.indexOf(e.id)!==-1){return true}return false})}return c}});fluid.Widgets=fluid.Collection.extend({model:fluid.models.Widget,initialize:function(c,b){if(b&&b.projectModel){this.projectModel=b.projectModel}},getIds:function(){return this.map(function(b){return b.id})},getElements:function(){return $("#"+this.getIds().join(", #"))},getRoots:function(){var b=new fluid.Widgets();this.each(function(d,c,e){b.add(d.getRoot())});return b},getLockTos:function(){var d=this.getRoots();var b=new fluid.Widgets();var c;d.each(function(e){c=fluid.main.project.widgets.where({lockTo:e.get("lockTo")});b.add(c)});return b}})})(fluid.util._);if(!fluid.models){fluid.models={}}fluid.models.Link=fluid.Model.extend({idAttribute:"linkCanvId",initialize:function(a,b){},parse:function(b,a){return b}});fluid.Links=fluid.Collection.extend({model:fluid.models.Link,linkProps:["linkCanvId","linkDest","linkOrigin","linkType","transType","triggerType"],initialize:function(b,a){},toJSON:function(c){var a={};for(var d=0,b=this.linkProps.length;d<b;d++){a[this.linkProps[d]]=[]}this.forEach(function(f){for(var g=0,e=this.linkProps.length;g<e;g++){a[this.linkProps[g]].push(f.attributes[this.linkProps[g]])}},this);return a},deserialize:function(k){var d=(typeof k==="string")?JSON.parse(k):k;var h=[],f,g,c,b,e,a;for(c=0,a=d.linkCanvId.length;c<a;c++){f={};for(b=0,e=this.linkProps.length;b<e;b++){f[this.linkProps[b]]=d[this.linkProps[b]][c]}h.push(f)}this.set(h,{merge:true})}});if(!fluid.models){fluid.models={}}fluid.models.WidgetGroup=fluid.Model.extend({initialize:function(a,b){},parse:function(b,a){return b}});fluid.WidgetGroups=fluid.Collection.extend({model:fluid.models.WidgetGroup,initialize:function(b,a){}});